<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT Master - 일본어 한자 학습 플랫폼</title>
    <!-- ResponsiveVoice.js for enhanced audio quality -->
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=lYd6ZO3y"></script>
    <!-- Pretendard Font -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <style>
        /* ===== 디자인 시스템: CSS 변수 (NEW) ===== */
        :root {
            /* 브랜드 색상 */
            --primary: #667eea;
            --primary-dark: #5568d3;
            --secondary: #764ba2;
            --accent: #f093fb;

            /* 시맨틱 색상 */
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;

            /* 그레이 스케일 */
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;

            /* 레벨 색상 */
            --level-n5: #4ade80;
            --level-n4: #60a5fa;
            --level-n3: #a78bfa;
            --level-n2: #fb923c;
            --level-n1: #f87171;

            /* 타이포그래피 */
            --font-sans: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            /* 폰트 크기 */
            --text-xs: 0.75rem;    /* 12px */
            --text-sm: 0.875rem;   /* 14px */
            --text-base: 1rem;     /* 16px */
            --text-lg: 1.125rem;   /* 18px */
            --text-xl: 1.25rem;    /* 20px */
            --text-2xl: 1.5rem;    /* 24px */
            --text-3xl: 1.875rem;  /* 30px */
            --text-4xl: 2.25rem;   /* 36px */
            --text-5xl: 3rem;      /* 48px */

            /* 스페이싱 */
            --space-1: 0.25rem;    /* 4px */
            --space-2: 0.5rem;     /* 8px */
            --space-3: 0.75rem;    /* 12px */
            --space-4: 1rem;       /* 16px */
            --space-5: 1.25rem;    /* 20px */
            --space-6: 1.5rem;     /* 24px */
            --space-8: 2rem;       /* 32px */
            --space-10: 2.5rem;    /* 40px */
            --space-12: 3rem;      /* 48px */
            --space-16: 4rem;      /* 64px */

            /* 그림자 */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);

            /* 보더 */
            --radius-sm: 0.375rem;  /* 6px */
            --radius-md: 0.5rem;    /* 8px */
            --radius-lg: 0.75rem;   /* 12px */
            --radius-xl: 1rem;      /* 16px */
            --radius-2xl: 1.5rem;   /* 24px */
            --radius-full: 9999px;

            /* 트랜지션 */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: var(--space-6);
            color: var(--gray-900);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* ===== 통합 헤더 디자인 (제목 + 레벨/스테이지 선택) ===== */
        .header {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            box-shadow: var(--shadow-lg);
            margin-bottom: var(--space-4);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-4);
            padding: 0 var(--space-2) var(--space-3) var(--space-2);
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: var(--space-3);
        }

        .header-bottom {
            display: flex;
            gap: var(--space-6);
            padding: 0 var(--space-2);
            flex-wrap: wrap;
        }

        .header-section {
            flex: 1;
            min-width: 250px;
        }

        .section-label {
            display: inline-block;
            font-size: var(--text-sm);
            font-weight: 700;
            color: var(--gray-700);
            margin-bottom: var(--space-2);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--text-xl);
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo-icon {
            font-size: var(--text-3xl);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .logo-main {
            font-size: var(--text-xl);
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-sub {
            font-size: var(--text-xs);
            color: var(--gray-500);
            font-weight: 500;
        }

        .header-stats {
            display: flex;
            gap: var(--space-6);
            align-items: center;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
        }

        .stat-label {
            font-size: var(--text-xs);
            color: var(--gray-500);
            font-weight: 500;
        }

        .stat-value {
            font-size: var(--text-lg);
            font-weight: 700;
            color: var(--gray-900);
        }

        .stat-value.primary { color: var(--primary); }
        .stat-value.success { color: var(--success); }
        .stat-value.warning { color: var(--warning); }


        /* ===== 대시보드 레이아웃 (NEW) ===== */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-6);
        }

        .dashboard-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            transition: var(--transition-base);
        }

        .dashboard-card:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .card-title {
            font-size: var(--text-lg);
            font-weight: 700;
            color: var(--gray-900);
        }

        .card-icon {
            font-size: var(--text-3xl);
        }

        /* ===== 레벨/스테이지 그리드 ===== */
        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: var(--space-2);
        }

        .stage-grid {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-2);
        }

        /* ===== 모드 선택 - 심플 디자인 ===== */
        .mode-selection {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--space-4);
        }

        .mode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--space-2);
        }

        .mode-card {
            background: white;
            color: var(--gray-900);
            border: 2px solid var(--gray-200);
            padding: var(--space-3);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-base);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
        }

        .mode-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
            background: var(--gray-50);
        }

        .mode-card-icon {
            font-size: var(--text-3xl);
        }

        .mode-card-title {
            font-size: var(--text-sm);
            font-weight: 600;
            color: var(--gray-900);
        }

        .mode-card-badge {
            font-size: 0.65rem;
            font-weight: 500;
            color: var(--gray-500);
        }

        /* 추천 모드 강조 */
        .mode-card.recommended {
            border-color: var(--success);
            background: var(--success);
            color: white;
        }

        .mode-card.recommended:hover {
            border-color: #059669;
            background: #059669;
        }

        .mode-card.recommended .mode-card-title,
        .mode-card.recommended .mode-card-badge {
            color: white;
        }

        .game-area {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            box-shadow: var(--shadow-xl);
            display: none;
        }

        .game-area.active {
            display: block;
        }

        /* 게임 모드 활성화 시 헤더와 모드 선택 숨기기 */

        /* 레벨/스테이지 선택이 있을 때 게임 영역과 분리 */
        body > div {
            display: flex;
            flex-direction: column;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 1em;
        }

        .back-btn:hover {
            background: #5a6268;
        }

        /* Flashcard Mode */
        .flashcard-container {
            perspective: 1000px;
            max-width: 600px;
            margin: 0 auto;
        }

        .flashcard {
            width: 100%;
            height: 400px;
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .flashcard.flip {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .card-front {
            background: #4A90E2;
            color: white;
        }

        .card-back {
            background: white;
            border: 3px solid #4A90E2;
            transform: rotateY(180deg);
        }

        .kanji-word {
            font-size: 5em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .reading {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .romaji {
            font-size: 1.5em;
            opacity: 0.9;
        }

        .card-back .meaning {
            font-size: 2.5em;
            font-weight: bold;
            color: #4A90E2;
            margin-bottom: 20px;
        }

        .hanja-info {
            font-size: 1.3em;
            color: #666;
            margin: 10px 0;
        }

        .example {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 1.1em;
        }

        .audio-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 20px 10px;
        }

        .audio-btn:hover {
            background: #218838;
        }

        .control-btns {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .control-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .know-btn {
            background: #28a745;
            color: white;
        }

        .know-btn:hover {
            background: #218838;
        }

        .dont-know-btn {
            background: #dc3545;
            color: white;
        }

        .dont-know-btn:hover {
            background: #c82333;
        }

        /* Multiple Choice Mode */
        .question-container {
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .question-word {
            font-size: 4em;
            font-weight: bold;
            color: #4A90E2;
            margin: 30px 0;
        }

        .question-reading {
            font-size: 1.8em;
            color: #666;
            margin-bottom: 40px;
        }

        .choices {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .choice-btn {
            padding: 25px;
            font-size: 1.3em;
            border: 3px solid #4A90E2;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .choice-btn:hover {
            background: #4A90E2;
            color: white;
        }

        .choice-btn.correct {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .choice-btn.wrong {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        .choice-btn:disabled {
            cursor: not-allowed;
        }

        /* Listening Mode */
        .listening-container {
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .play-audio-btn {
            background: #4A90E2;
            color: white;
            border: none;
            padding: 30px 50px;
            border-radius: 50%;
            font-size: 3em;
            cursor: pointer;
            margin: 40px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .play-audio-btn:hover {
            transform: scale(1.05);
        }

        /* Typing Mode */
        .typing-container {
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .typing-word {
            font-size: 5em;
            font-weight: bold;
            color: #4A90E2;
            margin: 30px 0;
        }

        .typing-hint {
            font-size: 1.5em;
            color: #666;
            margin-bottom: 30px;
        }

        .typing-input {
            width: 100%;
            padding: 20px;
            font-size: 2em;
            border: 3px solid #4A90E2;
            border-radius: 12px;
            text-align: center;
            outline: none;
        }

        .typing-input:focus {
            border-color: #4A90E2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .submit-btn {
            background: #4A90E2;
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 8px;
            font-size: 1.3em;
            cursor: pointer;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background: #4A90E2;
        }

        /* Matching Mode */
        .matching-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .matching-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .matching-column h3 {
            text-align: center;
            color: #4A90E2;
            margin-bottom: 20px;
        }

        .matching-item {
            padding: 20px;
            background: white;
            border: 3px solid #ddd;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .matching-item:hover {
            border-color: #4A90E2;
            transform: translateX(5px);
        }

        .matching-item.selected {
            background: #4A90E2;
            color: white;
            border-color: #4A90E2;
        }

        .matching-item.matched {
            background: #28a745;
            color: white;
            border-color: #28a745;
            cursor: default;
        }

        /* Speed Quiz Mode */
        .speed-container {
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .timer {
            font-size: 2.5em;
            font-weight: bold;
            color: #dc3545;
            margin: 20px 0;
        }

        .score {
            font-size: 2em;
            color: #28a745;
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: #4A90E2;
            transition: width 0.3s;
        }

        .keyboard-hint {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 1.1em;
            color: #666;
        }

        /* Audio Settings */
        .audio-settings {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 250px;
            z-index: 1000;
        }

        .audio-settings h4 {
            margin: 0 0 10px 0;
            color: #4A90E2;
            font-size: 1.1em;
        }

        .audio-settings label {
            display: block;
            margin: 8px 0;
            font-size: 0.9em;
            color: #666;
        }

        .audio-settings select,
        .audio-settings input[type="range"] {
            width: 100%;
            margin-top: 5px;
        }

        .audio-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4A90E2;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 999;
        }

        .audio-toggle:hover {
            background: #4A90E2;
        }

        /* Auto Study Mode - 공간 최적화 */
        .auto-study-container {
            text-align: center;
            width: 100%;
            height: calc(100vh - 100px);
            display: flex;
            flex-direction: column;
            padding: var(--space-2);
            box-sizing: border-box;
            gap: var(--space-2);
        }

        .auto-study-progress {
            font-size: var(--text-sm);
            font-weight: 600;
            color: var(--primary);
            padding: var(--space-1) 0;
            flex-shrink: 0;
        }

        .auto-study-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-2);
            padding: 0;
            flex-wrap: wrap;
            flex-shrink: 0;
        }

        .auto-study-btn {
            padding: var(--space-1) var(--space-3);
            font-size: var(--text-xs);
            font-weight: 600;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-base);
            box-shadow: var(--shadow-sm);
            white-space: nowrap;
        }

        .play-pause-btn {
            background: var(--success);
            color: white;
        }

        .play-pause-btn:hover {
            background: #059669;
        }

        .play-pause-btn.paused {
            background: var(--warning);
        }

        .stop-btn {
            background: var(--error);
            color: white;
        }

        .stop-btn:hover {
            background: #dc2626;
        }

        .auto-study-card {
            background: white;
            border: 2px solid var(--primary);
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: var(--shadow-lg);
            min-height: 0;
            overflow: hidden;
            position: relative;
        }

        .auto-study-card > div,
        .auto-study-card > * {
            flex-shrink: 1;
            min-height: 0;
        }

        .auto-study-word {
            font-size: clamp(3.5rem, 10vw, 8rem);
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-1);
            line-height: 1.1;
        }

        .auto-study-reading {
            font-size: clamp(1.2rem, 3.5vw, 2rem);
            color: var(--gray-600);
            margin-bottom: var(--space-1);
            line-height: 1.2;
        }

        .auto-study-meaning {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 700;
            color: var(--gray-900);
            margin: var(--space-1) 0;
            line-height: 1.2;
        }

        .auto-study-example {
            margin-top: var(--space-1);
            padding: var(--space-2);
            background: var(--gray-50);
            border-radius: var(--radius-md);
            font-size: clamp(0.8rem, 2vw, 1.1rem);
            line-height: 1.4;
            max-width: 90%;
        }

        .auto-study-status {
            padding: var(--space-1);
            background: var(--gray-100);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            color: var(--gray-600);
            font-weight: 500;
            flex-shrink: 0;
        }

        .result-screen {
            text-align: center;
            padding: 40px;
        }

        .result-screen h2 {
            font-size: 3em;
            color: #4A90E2;
            margin-bottom: 30px;
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .result-stat .label {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 10px;
        }

        .result-stat .value {
            font-size: 2.5em;
            font-weight: bold;
            color: #4A90E2;
        }

        @media (max-width: 768px) {
            .kanji-word {
                font-size: 3em;
            }

            .question-word {
                font-size: 2.5em;
            }

            .choices {
                grid-template-columns: 1fr;
            }

            .matching-grid {
                grid-template-columns: 1fr;
            }

            .auto-study-container {
                height: calc(100vh - 50px);
                padding: var(--space-1);
                gap: var(--space-1);
            }

            .auto-study-card {
                padding: var(--space-2);
                border-width: 1px;
            }

            .auto-study-word {
                font-size: clamp(2rem, 6vw, 4rem);
                margin-bottom: 0.25rem;
            }

            .auto-study-reading {
                font-size: clamp(1rem, 3vw, 1.5rem);
                margin-bottom: 0.25rem;
            }

            .auto-study-meaning {
                font-size: clamp(1.2rem, 3.5vw, 2rem);
                margin: 0.25rem 0;
            }

            .auto-study-example {
                max-width: 95%;
                padding: var(--space-1);
                margin-top: 0.25rem;
                font-size: clamp(0.7rem, 1.8vw, 1rem);
            }

            .auto-study-btn {
                padding: var(--space-1) var(--space-2);
                font-size: 0.65rem;
            }

            .auto-study-controls {
                gap: var(--space-1);
            }

            .auto-study-progress {
                font-size: 0.7rem;
                padding: 0.25rem 0;
            }

            /* 헤더 반응형 */
            .header {
                padding: var(--space-3);
            }

            .header-top {
                padding-bottom: var(--space-2);
            }

            .header-bottom {
                flex-direction: column;
                gap: var(--space-4);
            }

            .header-section {
                min-width: 100%;
            }

            .header-stats {
                gap: var(--space-3);
            }

            .stat-item {
                font-size: var(--text-xs);
            }
        }

        @media (max-width: 600px) {
            .header {
                padding: var(--space-2);
            }

            .header-stats {
                width: 100%;
                justify-content: space-between;
            }

            .stat-label {
                font-size: 0.65rem;
            }

            .stat-value {
                font-size: var(--text-sm);
            }

            .logo-main {
                font-size: var(--text-base);
            }

            .logo-sub {
                font-size: 0.65rem;
            }

            .section-label {
                font-size: 0.75rem;
            }
        }

        /* ===== 레벨별 색상 테마 (NEW) ===== */
        .level-btn.level-n5 {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%) !important;
            color: white !important;
            border-color: transparent !important;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3) !important;
        }

        .level-btn.level-n4 {
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%) !important;
            color: white !important;
            border-color: transparent !important;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3) !important;
        }

        .level-btn.level-n3 {
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%) !important;
            color: white !important;
            border-color: transparent !important;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3) !important;
        }

        .level-btn.level-n2 {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%) !important;
            color: white !important;
            border-color: transparent !important;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3) !important;
        }

        .level-btn.level-n1 {
            background: linear-gradient(135deg, #f87171 0%, #ef4444 100%) !important;
            color: white !important;
            border-color: transparent !important;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
        }

        .level-btn {
            padding: var(--space-2) var(--space-4) !important;
            font-size: var(--text-sm) !important;
            font-weight: 600 !important;
            border: 2px solid var(--gray-300) !important;
            border-radius: var(--radius-md) !important;
            cursor: pointer !important;
            min-height: 36px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            background: white;
            color: var(--gray-700);
            box-shadow: var(--shadow-sm) !important;
        }

        .level-btn:not(.level-n5):not(.level-n4):not(.level-n3):not(.level-n2):not(.level-n1):hover {
            transform: translateY(-2px) !important;
            box-shadow: var(--shadow-md) !important;
            border-color: var(--primary) !important;
            background: var(--gray-50);
        }

        .level-btn.level-n5:hover,
        .level-btn.level-n4:hover,
        .level-btn.level-n3:hover,
        .level-btn.level-n2:hover,
        .level-btn.level-n1:hover {
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2) !important;
        }

        .level-btn:active {
            transform: translateY(0) scale(0.98) !important;
        }

        /* ===== 향상된 카드 애니메이션 (NEW) ===== */
        @keyframes cardFlipIn {
            0% {
                transform: rotateY(180deg) scale(0.8);
                opacity: 0;
            }
            100% {
                transform: rotateY(180deg) scale(1);
                opacity: 1;
            }
        }

        @keyframes cardPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }

        .flashcard {
            animation: cardPulse 2s ease-in-out infinite;
        }

        .flashcard:hover {
            animation: none;
        }

        .card-face {
            transition: all 0.3s ease;
        }

        .card-front:hover, .card-back:hover {
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
        }

        /* ===== 진도 바 시각화 강화 (NEW) ===== */
        .progress-bar {
            position: relative;
            overflow: visible;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            background: linear-gradient(90deg, #4ade80 0%, #3b82f6 50%, #8b5cf6 100%);
            position: relative;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            animation: progressShine 2s ease-in-out infinite;
        }

        @keyframes progressShine {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* ===== 스테이지 버튼 향상 (NEW) ===== */
        .stage-btn {
            background: white !important;
            border: 1px solid var(--gray-300) !important;
            padding: var(--space-2) var(--space-3) !important;
            border-radius: var(--radius-sm) !important;
            cursor: pointer !important;
            font-size: var(--text-sm) !important;
            font-weight: 500 !important;
            min-height: 32px !important;
            min-width: 80px !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            color: var(--gray-700) !important;
            box-shadow: var(--shadow-sm) !important;
        }

        .stage-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: var(--shadow-md) !important;
            border-color: var(--primary) !important;
            background: var(--gray-50) !important;
        }

        .stage-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%) !important;
            color: white !important;
            border-color: var(--primary) !important;
            transform: scale(1.05) !important;
            font-weight: 700 !important;
            box-shadow: var(--shadow-lg) !important;
        }

        /* ===== 마이크로 인터랙션 (NEW) ===== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .mode-btn {
            animation: fadeInUp 0.5s ease-out;
            animation-fill-mode: both;
        }

        .mode-btn:nth-child(1) { animation-delay: 0.1s; }
        .mode-btn:nth-child(2) { animation-delay: 0.2s; }
        .mode-btn:nth-child(3) { animation-delay: 0.3s; }
        .mode-btn:nth-child(4) { animation-delay: 0.4s; }
        .mode-btn:nth-child(5) { animation-delay: 0.5s; }

        .mode-icon {
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
        }

        /* ===== 자동 학습 카드 개선 (NEW) ===== */
        .auto-study-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .auto-study-card:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        /* ===== 반응형 개선 (NEW) ===== */
        @media (max-width: 768px) {
            .level-btn {
                padding: 8px 12px !important;
                font-size: 0.85em !important;
            }

            .flashcard {
                height: 350px !important;
            }

            .kanji-word {
                font-size: 2.5em !important;
            }

            .reading {
                font-size: 1.5em !important;
            }

            .card-back .meaning {
                font-size: 2em !important;
            }
        }

        @media (max-width: 480px) {
            .level-btn {
                padding: 6px 10px !important;
                font-size: 0.75em !important;
            }

            .stage-btn {
                padding: 4px 8px !important;
                font-size: 0.75em !important;
            }

            .flashcard {
                height: 300px !important;
            }

            .control-btn {
                padding: 12px 24px !important;
                font-size: 1em !important;
            }
        }

        /* ===== 부드러운 페이드 전환 (NEW) ===== */
        .game-area {
            animation: fadeInUp 0.5s ease-out;
        }

        /* ===== 성공/실패 피드백 애니메이션 (NEW) ===== */
        @keyframes successPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 20px 10px rgba(34, 197, 94, 0);
            }
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .success-feedback {
            animation: successPulse 0.6s ease-out;
        }

        .error-feedback {
            animation: errorShake 0.5s ease-out;
        }

        /* ===== 홈 버튼 스타일 (NEW) ===== */
        .home-btn {
            background: transparent;
            border: 2px solid #4A90E2;
            color: #4A90E2;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .home-btn:hover {
            background: #4A90E2;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .home-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(74, 144, 226, 0.2);
        }

        @media (max-width: 600px) {
            .home-btn {
                padding: 6px 10px;
                font-size: 1em;
            }

            .home-btn span {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .home-btn {
                padding: 6px 8px;
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 통합 헤더 (제목 + 레벨/스테이지 선택) -->
        <header class="header" id="main-header">
            <div class="header-top">
                <div class="header-left">
                    <button onclick="goHome()" class="home-btn" title="홈으로 돌아가기">
                        🏠 <span>홈</span>
                    </button>
                    <div class="logo">
                        <span class="logo-icon">📚</span>
                        <div class="logo-text">
                            <span class="logo-main">JLPT Master</span>
                            <span class="logo-sub">일본어 한자 학습 플랫폼</span>
                        </div>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-item">
                        <span class="stat-label">학습한 단어</span>
                        <span class="stat-value primary" id="learned-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">정답률</span>
                        <span class="stat-value success" id="accuracy">0%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">연속 학습</span>
                        <span class="stat-value warning" id="streak">0일</span>
                    </div>
                </div>
            </div>

            <!-- 레벨 & 스테이지 선택 (헤더 하단) -->
            <div class="header-bottom">
                <div class="header-section">
                    <span class="section-label">📚 레벨</span>
                    <div class="level-grid">
                        <button onclick="selectLevel('N5')" class="level-btn level-n5 active" id="level-N5">N5</button>
                        <button onclick="selectLevel('N4')" class="level-btn" id="level-N4">N4</button>
                        <button onclick="selectLevel('N3')" class="level-btn" id="level-N3">N3</button>
                        <button onclick="selectLevel('N2')" class="level-btn" id="level-N2">N2</button>
                        <button onclick="selectLevel('N1')" class="level-btn" id="level-N1">N1</button>
                    </div>
                </div>

                <div class="header-section" id="stage-selection">
                    <span class="section-label">🎯 스테이지</span>
                    <div class="stage-grid" id="stage-buttons">
                        <!-- Stage buttons will be dynamically generated -->
                    </div>
                </div>
            </div>

            <!-- 현재 로딩 상태 텍스트 -->
            <div style="text-align: left; padding: 0.5rem 1rem; font-size: 0.85rem; color: #4a5568; background: rgba(102, 126, 234, 0.05);">
                📖 <span id="status-level-stage" style="font-weight: 700; color: #667eea;">-</span>
                <span style="color: #cbd5e0;">•</span>
                <span id="status-word-count" style="font-weight: 600;">0個</span>
                <span style="color: #cbd5e0;">•</span>
                <span id="status-word-preview">単語を読み込んでいます...</span>
            </div>
        </header>

        <div class="mode-selection" id="mode-selection">
            <div class="section-label" style="margin-bottom: var(--space-3);">
                🎮 学習モード選択
            </div>
            <div class="mode-grid">
                <div class="mode-card recommended" onclick="startMode('auto-study')">
                    <div class="mode-card-icon">🎓</div>
                    <div class="mode-card-title">자동 학습</div>
                    <span class="mode-card-badge">추천</span>
                </div>
                <div class="mode-card" onclick="startMode('flashcard')">
                    <div class="mode-card-icon">📇</div>
                    <div class="mode-card-title">플래시카드</div>
                    <span class="mode-card-badge">5-10분</span>
                </div>
                <div class="mode-card" onclick="startMode('multiple-choice')">
                    <div class="mode-card-icon">✅</div>
                    <div class="mode-card-title">객관식 퀴즈</div>
                    <span class="mode-card-badge">10-15분</span>
                </div>
                <div class="mode-card" onclick="startMode('listening')">
                    <div class="mode-card-icon">🎧</div>
                    <div class="mode-card-title">듣기 연습</div>
                    <span class="mode-card-badge">10분</span>
                </div>
                <div class="mode-card" onclick="startMode('typing')">
                    <div class="mode-card-icon">⌨️</div>
                    <div class="mode-card-title">타이핑 연습</div>
                    <span class="mode-card-badge">15-20분</span>
                </div>
                <div class="mode-card" onclick="startMode('matching')">
                    <div class="mode-card-icon">🔗</div>
                    <div class="mode-card-title">매칭 게임</div>
                    <span class="mode-card-badge">5-10분</span>
                </div>
                <div class="mode-card" onclick="startMode('speed')">
                    <div class="mode-card-icon">⚡</div>
                    <div class="mode-card-title">스피드 퀴즈</div>
                    <span class="mode-card-badge">5분</span>
                </div>
            </div>
        </div>

        <div class="game-area" id="game-area">
            <!-- Game content will be dynamically loaded here -->
        </div>
    </div>

    <!-- Audio Settings Toggle -->
    <button class="audio-toggle" onclick="toggleAudioSettings()" title="오디오 설정">🔊</button>
    <div class="audio-settings" id="audio-settings" style="display: none;">
        <h4>🎵 오디오 설정</h4>
        <label>
            음성 엔진:
            <select id="audio-engine" onchange="updateAudioSettings()">
                <option value="responsivevoice">Enhanced (ResponsiveVoice)</option>
                <option value="webspeech">Standard (Web Speech)</option>
            </select>
        </label>
        <label>
            음성 종류:
            <select id="voice-type" onchange="updateAudioSettings()">
                <option value="Japanese Female">일본어 여성</option>
                <option value="Japanese Male">일본어 남성</option>
            </select>
        </label>
        <label>
            속도: <span id="rate-value">0.85</span>x
            <input type="range" id="audio-rate" min="0.5" max="1.5" step="0.05" value="0.85" oninput="updateAudioSettings()">
        </label>
        <label>
            <input type="checkbox" id="auto-play-example" checked onchange="updateAudioSettings()">
            카드 뒤집을 때 예문 자동 재생
        </label>
    </div>

    <script>
        // Embedded vocabulary data
        const VOCABULARY_DATA = {"totalWords":153,"levels":{"N5":145,"N4":2,"N3":2,"N2":2,"N1":2},"words":[{"id":"k0001","word":"一","reading":"いち","romaji":"ichi","meaning":"하나","kanji":[{"char":"一","korean":"일","meaning":"한 일","reading":"いち"}],"partOfSpeech":"명사","example":{"jp":"一つください。","kr":"하나 주세요."},"level":"N5","frequency":5},{"id":"k0002","word":"二","reading":"に","romaji":"ni","meaning":"둘","kanji":[{"char":"二","korean":"이","meaning":"두 이","reading":"に"}],"partOfSpeech":"명사","example":{"jp":"二人で行きます。","kr":"두 명이서 갑니다."},"level":"N5","frequency":5},{"id":"k0003","word":"三","reading":"さん","romaji":"san","meaning":"셋","kanji":[{"char":"三","korean":"삼","meaning":"석 삼","reading":"さん"}],"partOfSpeech":"명사","example":{"jp":"三日後に会いましょう。","kr":"3일 후에 만나요."},"level":"N5","frequency":5},{"id":"k0004","word":"四","reading":"よん","romaji":"yon","meaning":"넷","kanji":[{"char":"四","korean":"사","meaning":"넉 사","reading":"よん"}],"partOfSpeech":"명사","example":{"jp":"四時に来てください。","kr":"4시에 와주세요."},"level":"N5","frequency":5},{"id":"k0005","word":"五","reading":"ご","romaji":"go","meaning":"다섯","kanji":[{"char":"五","korean":"오","meaning":"다섯 오","reading":"ご"}],"partOfSpeech":"명사","example":{"jp":"五分待ってください。","kr":"5분 기다려주세요."},"level":"N5","frequency":5},{"id":"k0006","word":"六","reading":"ろく","romaji":"roku","meaning":"여섯","kanji":[{"char":"六","korean":"육","meaning":"여섯 육","reading":"ろく"}],"partOfSpeech":"명사","example":{"jp":"六時に起きます。","kr":"6시에 일어납니다."},"level":"N5","frequency":5},{"id":"k0007","word":"七","reading":"なな","romaji":"nana","meaning":"일곱","kanji":[{"char":"七","korean":"칠","meaning":"일곱 칠","reading":"なな"}],"partOfSpeech":"명사","example":{"jp":"七月は暑いです。","kr":"7월은 덥습니다."},"level":"N5","frequency":5},{"id":"k0008","word":"八","reading":"はち","romaji":"hachi","meaning":"여덟","kanji":[{"char":"八","korean":"팔","meaning":"여덟 팔","reading":"はち"}],"partOfSpeech":"명사","example":{"jp":"八個買いました。","kr":"8개 샀습니다."},"level":"N5","frequency":5},{"id":"k0009","word":"九","reading":"きゅう","romaji":"kyuu","meaning":"아홉","kanji":[{"char":"九","korean":"구","meaning":"아홉 구","reading":"きゅう"}],"partOfSpeech":"명사","example":{"jp":"九時に寝ます。","kr":"9시에 잡니다."},"level":"N5","frequency":5},{"id":"k0010","word":"十","reading":"じゅう","romaji":"juu","meaning":"열","kanji":[{"char":"十","korean":"십","meaning":"열 십","reading":"じゅう"}],"partOfSpeech":"명사","example":{"jp":"十分あります。","kr":"충분히 있습니다."},"level":"N5","frequency":5},{"id":"k0011","word":"百","reading":"ひゃく","romaji":"hyaku","meaning":"백","kanji":[{"char":"百","korean":"백","meaning":"일백 백","reading":"ひゃく"}],"partOfSpeech":"명사","example":{"jp":"百円です。","kr":"100엔입니다."},"level":"N5","frequency":5},{"id":"k0012","word":"千","reading":"せん","romaji":"sen","meaning":"천","kanji":[{"char":"千","korean":"천","meaning":"일천 천","reading":"せん"}],"partOfSpeech":"명사","example":{"jp":"千円あります。","kr":"1000엔 있습니다."},"level":"N5","frequency":5},{"id":"k0013","word":"万","reading":"まん","romaji":"man","meaning":"만","kanji":[{"char":"万","korean":"만","meaning":"일만 만","reading":"まん"}],"partOfSpeech":"명사","example":{"jp":"一万円です。","kr":"1만엔입니다."},"level":"N5","frequency":5},{"id":"k0014","word":"円","reading":"えん","romaji":"en","meaning":"엔","kanji":[{"char":"円","korean":"원","meaning":"둥글 원","reading":"えん"}],"partOfSpeech":"명사","example":{"jp":"五百円ください。","kr":"500엔 주세요."},"level":"N5","frequency":5},{"id":"k0015","word":"日本","reading":"にほん","romaji":"nihon","meaning":"일본","kanji":[{"char":"日","korean":"일","meaning":"날 일","reading":"にち"},{"char":"本","korean":"본","meaning":"근본 본","reading":"ほん"}],"partOfSpeech":"명사","example":{"jp":"日本に行きます。","kr":"일본에 갑니다."},"level":"N5","frequency":5},{"id":"k0016","word":"人","reading":"ひと","romaji":"hito","meaning":"사람","kanji":[{"char":"人","korean":"인","meaning":"사람 인","reading":"ひと"}],"partOfSpeech":"명사","example":{"jp":"あの人は誰ですか。","kr":"저 사람은 누구입니까?"},"level":"N5","frequency":5},{"id":"k0017","word":"年","reading":"とし","romaji":"toshi","meaning":"해","kanji":[{"char":"年","korean":"년","meaning":"해 년","reading":"とし"}],"partOfSpeech":"명사","example":{"jp":"今年は2025年です。","kr":"올해는 2025년입니다."},"level":"N5","frequency":5},{"id":"k0018","word":"時間","reading":"じかん","romaji":"jikan","meaning":"시간","kanji":[{"char":"時","korean":"시","meaning":"때 시","reading":"じ"},{"char":"間","korean":"간","meaning":"사이 간","reading":"かん"}],"partOfSpeech":"명사","example":{"jp":"時間がありません。","kr":"시간이 없습니다."},"level":"N5","frequency":5},{"id":"k0019","word":"今","reading":"いま","romaji":"ima","meaning":"지금","kanji":[{"char":"今","korean":"금","meaning":"이제 금","reading":"いま"}],"partOfSpeech":"명사","example":{"jp":"今、何時ですか。","kr":"지금 몇 시입니까?"},"level":"N5","frequency":5},{"id":"k0020","word":"今日","reading":"きょう","romaji":"kyou","meaning":"오늘","kanji":[{"char":"今","korean":"금","meaning":"이제 금","reading":"きょ"},{"char":"日","korean":"일","meaning":"날 일","reading":"う"}],"partOfSpeech":"명사","example":{"jp":"今日は暑いです。","kr":"오늘은 덥습니다."},"level":"N5","frequency":5},{"id":"k0021","word":"明日","reading":"あした","romaji":"ashita","meaning":"내일","kanji":[{"char":"明","korean":"명","meaning":"밝을 명","reading":"あ"},{"char":"日","korean":"일","meaning":"날 일","reading":"した"}],"partOfSpeech":"명사","example":{"jp":"明日会いましょう。","kr":"내일 만나요."},"level":"N5","frequency":5},{"id":"k0022","word":"昨日","reading":"きのう","romaji":"kinou","meaning":"어제","kanji":[{"char":"昨","korean":"작","meaning":"어제 작","reading":"き"},{"char":"日","korean":"일","meaning":"날 일","reading":"のう"}],"partOfSpeech":"명사","example":{"jp":"昨日は雨でした。","kr":"어제는 비였습니다."},"level":"N5","frequency":5},{"id":"k0023","word":"毎日","reading":"まいにち","romaji":"mainichi","meaning":"매일","kanji":[{"char":"毎","korean":"매","meaning":"매양 매","reading":"まい"},{"char":"日","korean":"일","meaning":"날 일","reading":"にち"}],"partOfSpeech":"명사","example":{"jp":"毎日勉強します。","kr":"매일 공부합니다."},"level":"N5","frequency":5},{"id":"k0024","word":"月曜日","reading":"げつようび","romaji":"getsuyoubi","meaning":"월요일","kanji":[{"char":"月","korean":"월","meaning":"달 월","reading":"げつ"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"月曜日は忙しいです。","kr":"월요일은 바쁩니다."},"level":"N5","frequency":5},{"id":"k0025","word":"火曜日","reading":"かようび","romaji":"kayoubi","meaning":"화요일","kanji":[{"char":"火","korean":"화","meaning":"불 화","reading":"か"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"火曜日に会いましょう。","kr":"화요일에 만나요."},"level":"N5","frequency":5},{"id":"k0026","word":"水曜日","reading":"すいようび","romaji":"suiyoubi","meaning":"수요일","kanji":[{"char":"水","korean":"수","meaning":"물 수","reading":"すい"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"水曜日は休みです。","kr":"수요일은 쉽니다."},"level":"N5","frequency":5},{"id":"k0027","word":"木曜日","reading":"もくようび","romaji":"mokuyoubi","meaning":"목요일","kanji":[{"char":"木","korean":"목","meaning":"나무 목","reading":"もく"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"木曜日にテストがあります。","kr":"목요일에 시험이 있습니다."},"level":"N5","frequency":5},{"id":"k0028","word":"金曜日","reading":"きんようび","romaji":"kinyoubi","meaning":"금요일","kanji":[{"char":"金","korean":"금","meaning":"쇠 금","reading":"きん"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"金曜日が楽しみです。","kr":"금요일이 기대됩니다."},"level":"N5","frequency":5},{"id":"k0029","word":"土曜日","reading":"どようび","romaji":"doyoubi","meaning":"토요일","kanji":[{"char":"土","korean":"토","meaning":"흙 토","reading":"ど"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"土曜日は買い物をします。","kr":"토요일은 쇼핑을 합니다."},"level":"N5","frequency":5},{"id":"k0030","word":"日曜日","reading":"にちようび","romaji":"nichiyoubi","meaning":"일요일","kanji":[{"char":"日","korean":"일","meaning":"날 일","reading":"にち"},{"char":"曜","korean":"요","meaning":"빛날 요","reading":"よう"},{"char":"日","korean":"일","meaning":"날 일","reading":"び"}],"partOfSpeech":"명사","example":{"jp":"日曜日はゆっくり休みます。","kr":"일요일은 푹 쉽니다."},"level":"N5","frequency":5},{"id":"k0031","word":"食べる","reading":"たべる","romaji":"taberu","meaning":"먹다","kanji":[{"char":"食","korean":"식","meaning":"먹을 식","reading":"た"}],"partOfSpeech":"동사","example":{"jp":"朝ごはんを食べます。","kr":"아침밥을 먹습니다."},"level":"N5","frequency":5},{"id":"k0032","word":"飲む","reading":"のむ","romaji":"nomu","meaning":"마시다","kanji":[{"char":"飲","korean":"음","meaning":"마실 음","reading":"の"}],"partOfSpeech":"동사","example":{"jp":"水を飲みます。","kr":"물을 마십니다."},"level":"N5","frequency":5},{"id":"k0033","word":"見る","reading":"みる","romaji":"miru","meaning":"보다","kanji":[{"char":"見","korean":"견","meaning":"볼 견","reading":"み"}],"partOfSpeech":"동사","example":{"jp":"映画を見ます。","kr":"영화를 봅니다."},"level":"N5","frequency":5},{"id":"k0034","word":"聞く","reading":"きく","romaji":"kiku","meaning":"듣다","kanji":[{"char":"聞","korean":"문","meaning":"들을 문","reading":"き"}],"partOfSpeech":"동사","example":{"jp":"音楽を聞きます。","kr":"음악을 듣습니다."},"level":"N5","frequency":5},{"id":"k0035","word":"読む","reading":"よむ","romaji":"yomu","meaning":"읽다","kanji":[{"char":"読","korean":"독","meaning":"읽을 독","reading":"よ"}],"partOfSpeech":"동사","example":{"jp":"本を読みます。","kr":"책을 읽습니다."},"level":"N5","frequency":5},{"id":"k0036","word":"書く","reading":"かく","romaji":"kaku","meaning":"쓰다","kanji":[{"char":"書","korean":"서","meaning":"글 서","reading":"か"}],"partOfSpeech":"동사","example":{"jp":"手紙を書きます。","kr":"편지를 씁니다."},"level":"N5","frequency":5},{"id":"k0037","word":"話す","reading":"はなす","romaji":"hanasu","meaning":"말하다","kanji":[{"char":"話","korean":"화","meaning":"말씀 화","reading":"はな"}],"partOfSpeech":"동사","example":{"jp":"日本語を話します。","kr":"일본어를 합니다."},"level":"N5","frequency":5},{"id":"k0038","word":"行く","reading":"いく","romaji":"iku","meaning":"가다","kanji":[{"char":"行","korean":"행","meaning":"갈 행","reading":"い"}],"partOfSpeech":"동사","example":{"jp":"学校に行きます。","kr":"학교에 갑니다."},"level":"N5","frequency":5},{"id":"k0039","word":"来る","reading":"くる","romaji":"kuru","meaning":"오다","kanji":[{"char":"来","korean":"래","meaning":"올 래","reading":"く"}],"partOfSpeech":"동사","example":{"jp":"明日来てください。","kr":"내일 와주세요."},"level":"N5","frequency":5},{"id":"k0040","word":"帰る","reading":"かえる","romaji":"kaeru","meaning":"돌아가다","kanji":[{"char":"帰","korean":"귀","meaning":"돌아갈 귀","reading":"かえ"}],"partOfSpeech":"동사","example":{"jp":"家に帰ります。","kr":"집에 돌아갑니다."},"level":"N5","frequency":5},{"id":"k0041","word":"買う","reading":"かう","romaji":"kau","meaning":"사다","kanji":[{"char":"買","korean":"매","meaning":"살 매","reading":"か"}],"partOfSpeech":"동사","example":{"jp":"本を買います。","kr":"책을 삽니다."},"level":"N5","frequency":5},{"id":"k0042","word":"売る","reading":"うる","romaji":"uru","meaning":"팔다","kanji":[{"char":"売","korean":"매","meaning":"팔 매","reading":"う"}],"partOfSpeech":"동사","example":{"jp":"車を売ります。","kr":"차를 팝니다."},"level":"N5","frequency":5},{"id":"k0043","word":"作る","reading":"つくる","romaji":"tsukuru","meaning":"만들다","kanji":[{"char":"作","korean":"작","meaning":"지을 작","reading":"つく"}],"partOfSpeech":"동사","example":{"jp":"料理を作ります。","kr":"요리를 만듭니다."},"level":"N5","frequency":5},{"id":"k0044","word":"使う","reading":"つかう","romaji":"tsukau","meaning":"사용하다","kanji":[{"char":"使","korean":"사","meaning":"부릴 사","reading":"つか"}],"partOfSpeech":"동사","example":{"jp":"パソコンを使います。","kr":"컴퓨터를 사용합니다."},"level":"N5","frequency":5},{"id":"k0045","word":"待つ","reading":"まつ","romaji":"matsu","meaning":"기다리다","kanji":[{"char":"待","korean":"대","meaning":"기다릴 대","reading":"ま"}],"partOfSpeech":"동사","example":{"jp":"ここで待ってください。","kr":"여기서 기다려주세요."},"level":"N5","frequency":5},{"id":"k0046","word":"立つ","reading":"たつ","romaji":"tatsu","meaning":"서다","kanji":[{"char":"立","korean":"립","meaning":"설 립","reading":"た"}],"partOfSpeech":"동사","example":{"jp":"立ってください。","kr":"서주세요."},"level":"N5","frequency":5},{"id":"k0047","word":"座る","reading":"すわる","romaji":"suwaru","meaning":"앉다","kanji":[{"char":"座","korean":"좌","meaning":"앉을 좌","reading":"すわ"}],"partOfSpeech":"동사","example":{"jp":"ここに座ってください。","kr":"여기 앉아주세요."},"level":"N5","frequency":5},{"id":"k0048","word":"歩く","reading":"あるく","romaji":"aruku","meaning":"걷다","kanji":[{"char":"歩","korean":"보","meaning":"걸을 보","reading":"ある"}],"partOfSpeech":"동사","example":{"jp":"公園を歩きます。","kr":"공원을 걷습니다."},"level":"N5","frequency":5},{"id":"k0049","word":"走る","reading":"はしる","romaji":"hashiru","meaning":"뛰다","kanji":[{"char":"走","korean":"주","meaning":"달릴 주","reading":"はし"}],"partOfSpeech":"동사","example":{"jp":"毎朝走ります。","kr":"매일 아침 뜁니다."},"level":"N5","frequency":5},{"id":"k0050","word":"泳ぐ","reading":"およぐ","romaji":"oyogu","meaning":"수영하다","kanji":[{"char":"泳","korean":"영","meaning":"헤엄칠 영","reading":"およ"}],"partOfSpeech":"동사","example":{"jp":"プールで泳ぎます。","kr":"수영장에서 수영합니다."},"level":"N5","frequency":5},{"id":"k0051","word":"学校","reading":"がっこう","romaji":"gakkou","meaning":"학교","kanji":[{"char":"学","korean":"학","meaning":"배울 학","reading":"がく"},{"char":"校","korean":"교","meaning":"학교 교","reading":"こう"}],"partOfSpeech":"명사","example":{"jp":"学校に行きます。","kr":"학교에 갑니다."},"level":"N5","frequency":5},{"id":"k0052","word":"大学","reading":"だいがく","romaji":"daigaku","meaning":"대학교","kanji":[{"char":"大","korean":"대","meaning":"큰 대","reading":"だい"},{"char":"学","korean":"학","meaning":"배울 학","reading":"がく"}],"partOfSpeech":"명사","example":{"jp":"大学で勉強します。","kr":"대학교에서 공부합니다."},"level":"N5","frequency":5},{"id":"k0053","word":"会社","reading":"かいしゃ","romaji":"kaisha","meaning":"회사","kanji":[{"char":"会","korean":"회","meaning":"모일 회","reading":"かい"},{"char":"社","korean":"사","meaning":"모일 사","reading":"しゃ"}],"partOfSpeech":"명사","example":{"jp":"会社で働きます。","kr":"회사에서 일합니다."},"level":"N5","frequency":5},{"id":"k0054","word":"駅","reading":"えき","romaji":"eki","meaning":"역","kanji":[{"char":"駅","korean":"역","meaning":"역 역","reading":"えき"}],"partOfSpeech":"명사","example":{"jp":"駅で待っています。","kr":"역에서 기다리고 있습니다."},"level":"N5","frequency":5},{"id":"k0055","word":"病院","reading":"びょういん","romaji":"byouin","meaning":"병원","kanji":[{"char":"病","korean":"병","meaning":"병 병","reading":"びょう"},{"char":"院","korean":"원","meaning":"집 원","reading":"いん"}],"partOfSpeech":"명사","example":{"jp":"病院に行きます。","kr":"병원에 갑니다."},"level":"N5","frequency":5},{"id":"k0056","word":"店","reading":"みせ","romaji":"mise","meaning":"가게","kanji":[{"char":"店","korean":"점","meaning":"가게 점","reading":"みせ"}],"partOfSpeech":"명사","example":{"jp":"新しい店ができました。","kr":"새로운 가게가 생겼습니다."},"level":"N5","frequency":5},{"id":"k0057","word":"銀行","reading":"ぎんこう","romaji":"ginkou","meaning":"은행","kanji":[{"char":"銀","korean":"은","meaning":"은 은","reading":"ぎん"},{"char":"行","korean":"행","meaning":"갈 행","reading":"こう"}],"partOfSpeech":"명사","example":{"jp":"銀行でお金を下ろします。","kr":"은행에서 돈을 찾습니다."},"level":"N5","frequency":5},{"id":"k0058","word":"図書館","reading":"としょかん","romaji":"toshokan","meaning":"도서관","kanji":[{"char":"図","korean":"도","meaning":"그림 도","reading":"と"},{"char":"書","korean":"서","meaning":"글 서","reading":"しょ"},{"char":"館","korean":"관","meaning":"집 관","reading":"かん"}],"partOfSpeech":"명사","example":{"jp":"図書館で本を借ります。","kr":"도서관에서 책을 빌립니다."},"level":"N5","frequency":5},{"id":"k0059","word":"家","reading":"いえ","romaji":"ie","meaning":"집","kanji":[{"char":"家","korean":"가","meaning":"집 가","reading":"いえ"}],"partOfSpeech":"명사","example":{"jp":"家にいます。","kr":"집에 있습니다."},"level":"N5","frequency":5},{"id":"k0060","word":"部屋","reading":"へや","romaji":"heya","meaning":"방","kanji":[{"char":"部","korean":"부","meaning":"떼 부","reading":"へ"},{"char":"屋","korean":"옥","meaning":"집 옥","reading":"や"}],"partOfSpeech":"명사","example":{"jp":"部屋を掃除します。","kr":"방을 청소합니다."},"level":"N5","frequency":5},{"id":"k0061","word":"父","reading":"ちち","romaji":"chichi","meaning":"아버지","kanji":[{"char":"父","korean":"부","meaning":"아비 부","reading":"ちち"}],"partOfSpeech":"명사","example":{"jp":"父は会社員です。","kr":"아버지는 회사원입니다."},"level":"N5","frequency":5},{"id":"k0062","word":"母","reading":"はは","romaji":"haha","meaning":"어머니","kanji":[{"char":"母","korean":"모","meaning":"어미 모","reading":"はは"}],"partOfSpeech":"명사","example":{"jp":"母は料理が上手です。","kr":"어머니는 요리를 잘합니다."},"level":"N5","frequency":5},{"id":"k0063","word":"兄","reading":"あに","romaji":"ani","meaning":"형","kanji":[{"char":"兄","korean":"형","meaning":"형 형","reading":"あに"}],"partOfSpeech":"명사","example":{"jp":"兄は大学生です。","kr":"형은 대학생입니다."},"level":"N5","frequency":5},{"id":"k0064","word":"姉","reading":"あね","romaji":"ane","meaning":"누나","kanji":[{"char":"姉","korean":"자","meaning":"누이 자","reading":"あね"}],"partOfSpeech":"명사","example":{"jp":"姉は東京に住んでいます。","kr":"언니는 도쿄에 살고 있습니다."},"level":"N5","frequency":5},{"id":"k0065","word":"弟","reading":"おとうと","romaji":"otouto","meaning":"남동생","kanji":[{"char":"弟","korean":"제","meaning":"아우 제","reading":"おとうと"}],"partOfSpeech":"명사","example":{"jp":"弟は高校生です。","kr":"남동생은 고등학생입니다."},"level":"N5","frequency":5},{"id":"k0066","word":"妹","reading":"いもうと","romaji":"imouto","meaning":"여동생","kanji":[{"char":"妹","korean":"매","meaning":"누이동생 매","reading":"いもうと"}],"partOfSpeech":"명사","example":{"jp":"妹はまだ小学生です。","kr":"여동생은 아직 초등학생입니다."},"level":"N5","frequency":5},{"id":"k0067","word":"子","reading":"こ","romaji":"ko","meaning":"아이","kanji":[{"char":"子","korean":"자","meaning":"아들 자","reading":"こ"}],"partOfSpeech":"명사","example":{"jp":"子供が三人います。","kr":"아이가 세 명 있습니다."},"level":"N5","frequency":5},{"id":"k0068","word":"大きい","reading":"おおきい","romaji":"ookii","meaning":"크다","kanji":[{"char":"大","korean":"대","meaning":"큰 대","reading":"おお"}],"partOfSpeech":"형용사","example":{"jp":"大きい家に住んでいます。","kr":"큰 집에 살고 있습니다."},"level":"N5","frequency":5},{"id":"k0069","word":"小さい","reading":"ちいさい","romaji":"chiisai","meaning":"작다","kanji":[{"char":"小","korean":"소","meaning":"작을 소","reading":"ちい"}],"partOfSpeech":"형용사","example":{"jp":"小さい犬が好きです。","kr":"작은 개를 좋아합니다."},"level":"N5","frequency":5},{"id":"k0070","word":"新しい","reading":"あたらしい","romaji":"atarashii","meaning":"새롭다","kanji":[{"char":"新","korean":"신","meaning":"새 신","reading":"あたら"}],"partOfSpeech":"형용사","example":{"jp":"新しい車を買いました。","kr":"새 차를 샀습니다."},"level":"N5","frequency":5},{"id":"k0071","word":"古い","reading":"ふるい","romaji":"furui","meaning":"낡다","kanji":[{"char":"古","korean":"고","meaning":"옛 고","reading":"ふる"}],"partOfSpeech":"형용사","example":{"jp":"古い建物です。","kr":"오래된 건물입니다."},"level":"N5","frequency":5},{"id":"k0072","word":"高い","reading":"たかい","romaji":"takai","meaning":"높다","kanji":[{"char":"高","korean":"고","meaning":"높을 고","reading":"たか"}],"partOfSpeech":"형용사","example":{"jp":"この時計は高いです。","kr":"이 시계는 비쌉니다."},"level":"N5","frequency":5},{"id":"k0073","word":"安い","reading":"やすい","romaji":"yasui","meaning":"싸다","kanji":[{"char":"安","korean":"안","meaning":"편안할 안","reading":"やす"}],"partOfSpeech":"형용사","example":{"jp":"安い店を探しています。","kr":"싼 가게를 찾고 있습니다."},"level":"N5","frequency":5},{"id":"k0074","word":"良い","reading":"いい","romaji":"ii","meaning":"좋다","kanji":[{"char":"良","korean":"량","meaning":"좋을 량","reading":"よ"}],"partOfSpeech":"형용사","example":{"jp":"天気が良いです。","kr":"날씨가 좋습니다."},"level":"N5","frequency":5},{"id":"k0075","word":"悪い","reading":"わるい","romaji":"warui","meaning":"나쁘다","kanji":[{"char":"悪","korean":"악","meaning":"나쁠 악","reading":"わる"}],"partOfSpeech":"형용사","example":{"jp":"気分が悪いです。","kr":"기분이 나쁩니다."},"level":"N5","frequency":5},{"id":"k0076","word":"長い","reading":"ながい","romaji":"nagai","meaning":"길다","kanji":[{"char":"長","korean":"장","meaning":"길 장","reading":"なが"}],"partOfSpeech":"형용사","example":{"jp":"長い時間がかかります。","kr":"긴 시간이 걸립니다."},"level":"N5","frequency":5},{"id":"k0077","word":"短い","reading":"みじかい","romaji":"mijikai","meaning":"짧다","kanji":[{"char":"短","korean":"단","meaning":"짧을 단","reading":"みじか"}],"partOfSpeech":"형용사","example":{"jp":"短い休みです。","kr":"짧은 휴식입니다."},"level":"N5","frequency":5},{"id":"k0078","word":"多い","reading":"おおい","romaji":"ooi","meaning":"많다","kanji":[{"char":"多","korean":"다","meaning":"많을 다","reading":"おお"}],"partOfSpeech":"형용사","example":{"jp":"人が多いです。","kr":"사람이 많습니다."},"level":"N5","frequency":5},{"id":"k0079","word":"少ない","reading":"すくない","romaji":"sukunai","meaning":"적다","kanji":[{"char":"少","korean":"소","meaning":"적을 소","reading":"すく"}],"partOfSpeech":"형용사","example":{"jp":"時間が少ないです。","kr":"시간이 적습니다."},"level":"N5","frequency":5},{"id":"k0080","word":"早い","reading":"はやい","romaji":"hayai","meaning":"이르다","kanji":[{"char":"早","korean":"조","meaning":"이를 조","reading":"はや"}],"partOfSpeech":"형용사","example":{"jp":"朝早く起きます。","kr":"아침 일찍 일어납니다."},"level":"N5","frequency":5},{"id":"k0081","word":"遅い","reading":"おそい","romaji":"osoi","meaning":"늦다","kanji":[{"char":"遅","korean":"지","meaning":"늦을 지","reading":"おそ"}],"partOfSpeech":"형용사","example":{"jp":"電車が遅れています。","kr":"전차가 늦어지고 있습니다."},"level":"N5","frequency":5},{"id":"k0082","word":"近い","reading":"ちかい","romaji":"chikai","meaning":"가깝다","kanji":[{"char":"近","korean":"근","meaning":"가까울 근","reading":"ちか"}],"partOfSpeech":"형용사","example":{"jp":"駅が近いです。","kr":"역이 가깝습니다."},"level":"N5","frequency":5},{"id":"k0083","word":"遠い","reading":"とおい","romaji":"tooi","meaning":"멀다","kanji":[{"char":"遠","korean":"원","meaning":"멀 원","reading":"とお"}],"partOfSpeech":"형용사","example":{"jp":"会社が遠いです。","kr":"회사가 멀니다."},"level":"N5","frequency":5},{"id":"k0084","word":"白い","reading":"しろい","romaji":"shiroi","meaning":"하얗다","kanji":[{"char":"白","korean":"백","meaning":"흰 백","reading":"しろ"}],"partOfSpeech":"형용사","example":{"jp":"白いシャツを着ています。","kr":"흰 셔츠를 입고 있습니다."},"level":"N5","frequency":5},{"id":"k0085","word":"黒い","reading":"くろい","romaji":"kuroi","meaning":"검다","kanji":[{"char":"黒","korean":"흑","meaning":"검을 흑","reading":"くろ"}],"partOfSpeech":"형용사","example":{"jp":"黒い猫がいます。","kr":"검은 고양이가 있습니다."},"level":"N5","frequency":5},{"id":"k0086","word":"赤い","reading":"あかい","romaji":"akai","meaning":"빨갛다","kanji":[{"char":"赤","korean":"적","meaning":"붉을 적","reading":"あか"}],"partOfSpeech":"형용사","example":{"jp":"赤い花が咲いています。","kr":"빨간 꽃이 피어 있습니다."},"level":"N5","frequency":5},{"id":"k0087","word":"青い","reading":"あおい","romaji":"aoi","meaning":"파랗다","kanji":[{"char":"青","korean":"청","meaning":"푸를 청","reading":"あお"}],"partOfSpeech":"형용사","example":{"jp":"青い空が綺麗です。","kr":"파란 하늘이 예쁩니다."},"level":"N5","frequency":5},{"id":"k0088","word":"友達","reading":"ともだち","romaji":"tomodachi","meaning":"친구","kanji":[{"char":"友","korean":"우","meaning":"벗 우","reading":"とも"},{"char":"達","korean":"달","meaning":"이를 달","reading":"だち"}],"partOfSpeech":"명사","example":{"jp":"友達と遊びます。","kr":"친구와 놉니다."},"level":"N5","frequency":5},{"id":"k0089","word":"先生","reading":"せんせい","romaji":"sensei","meaning":"선생님","kanji":[{"char":"先","korean":"선","meaning":"먼저 선","reading":"せん"},{"char":"生","korean":"생","meaning":"날 생","reading":"せい"}],"partOfSpeech":"명사","example":{"jp":"先生に質問します。","kr":"선생님께 질문합니다."},"level":"N5","frequency":5},{"id":"k0090","word":"学生","reading":"がくせい","romaji":"gakusei","meaning":"학생","kanji":[{"char":"学","korean":"학","meaning":"배울 학","reading":"がく"},{"char":"生","korean":"생","meaning":"날 생","reading":"せい"}],"partOfSpeech":"명사","example":{"jp":"私は学生です。","kr":"저는 학생입니다."},"level":"N5","frequency":5},{"id":"k0091","word":"本","reading":"ほん","romaji":"hon","meaning":"책","kanji":[{"char":"本","korean":"본","meaning":"근본 본","reading":"ほん"}],"partOfSpeech":"명사","example":{"jp":"本を読むのが好きです。","kr":"책 읽는 것을 좋아합니다."},"level":"N5","frequency":5},{"id":"k0092","word":"車","reading":"くるま","romaji":"kuruma","meaning":"차","kanji":[{"char":"車","korean":"차","meaning":"수레 차","reading":"くるま"}],"partOfSpeech":"명사","example":{"jp":"新しい車が欲しいです。","kr":"새 차를 갖고 싶습니다."},"level":"N5","frequency":5},{"id":"k0093","word":"電車","reading":"でんしゃ","romaji":"densha","meaning":"전철","kanji":[{"char":"電","korean":"전","meaning":"번개 전","reading":"でん"},{"char":"車","korean":"차","meaning":"수레 차","reading":"しゃ"}],"partOfSpeech":"명사","example":{"jp":"電車で通勤します。","kr":"전철로 출근합니다."},"level":"N5","frequency":5},{"id":"k0094","word":"電話","reading":"でんわ","romaji":"denwa","meaning":"전화","kanji":[{"char":"電","korean":"전","meaning":"번개 전","reading":"でん"},{"char":"話","korean":"화","meaning":"말씀 화","reading":"わ"}],"partOfSpeech":"명사","example":{"jp":"電話をかけます。","kr":"전화를 겁니다."},"level":"N5","frequency":5},{"id":"k0095","word":"手","reading":"て","romaji":"te","meaning":"손","kanji":[{"char":"手","korean":"수","meaning":"손 수","reading":"て"}],"partOfSpeech":"명사","example":{"jp":"手を洗ってください。","kr":"손을 씻어주세요."},"level":"N5","frequency":5},{"id":"k0096","word":"足","reading":"あし","romaji":"ashi","meaning":"발","kanji":[{"char":"足","korean":"족","meaning":"발 족","reading":"あし"}],"partOfSpeech":"명사","example":{"jp":"足が痛いです。","kr":"발이 아픕니다."},"level":"N5","frequency":5},{"id":"k0097","word":"目","reading":"め","romaji":"me","meaning":"눈","kanji":[{"char":"目","korean":"목","meaning":"눈 목","reading":"め"}],"partOfSpeech":"명사","example":{"jp":"目が悪いです。","kr":"눈이 나쁩니다."},"level":"N5","frequency":5},{"id":"k0098","word":"耳","reading":"みみ","romaji":"mimi","meaning":"귀","kanji":[{"char":"耳","korean":"이","meaning":"귀 이","reading":"みみ"}],"partOfSpeech":"명사","example":{"jp":"耳が聞こえません。","kr":"귀가 안 들립니다."},"level":"N5","frequency":5},{"id":"k0099","word":"口","reading":"くち","romaji":"kuchi","meaning":"입","kanji":[{"char":"口","korean":"구","meaning":"입 구","reading":"くち"}],"partOfSpeech":"명사","example":{"jp":"口を開けてください。","kr":"입을 열어주세요."},"level":"N5","frequency":5},{"id":"k0100","word":"頭","reading":"あたま","romaji":"atama","meaning":"머리","kanji":[{"char":"頭","korean":"두","meaning":"머리 두","reading":"あたま"}],"partOfSpeech":"명사","example":{"jp":"頭が痛いです。","kr":"머리가 아픕니다."},"level":"N5","frequency":5},{"id":"k0101","word":"天気","reading":"てんき","romaji":"tenki","meaning":"날씨","kanji":[{"char":"天","korean":"천","meaning":"하늘 천","reading":"てん"},{"char":"気","korean":"기","meaning":"기운 기","reading":"き"}],"partOfSpeech":"명사","example":{"jp":"今日は天気がいいです。","kr":"오늘은 날씨가 좋습니다."},"level":"N5","frequency":5},{"id":"k0102","word":"雨","reading":"あめ","romaji":"ame","meaning":"비","kanji":[{"char":"雨","korean":"우","meaning":"비 우","reading":"あめ"}],"partOfSpeech":"명사","example":{"jp":"雨が降っています。","kr":"비가 내리고 있습니다."},"level":"N5","frequency":5},{"id":"k0103","word":"雪","reading":"ゆき","romaji":"yuki","meaning":"눈","kanji":[{"char":"雪","korean":"설","meaning":"눈 설","reading":"ゆき"}],"partOfSpeech":"명사","example":{"jp":"雪が積もっています。","kr":"눈이 쌓여 있습니다."},"level":"N5","frequency":5},{"id":"k0104","word":"風","reading":"かぜ","romaji":"kaze","meaning":"바람","kanji":[{"char":"風","korean":"풍","meaning":"바람 풍","reading":"かぜ"}],"partOfSpeech":"명사","example":{"jp":"風が強いです。","kr":"바람이 강합니다."},"level":"N5","frequency":5},{"id":"k0105","word":"山","reading":"やま","romaji":"yama","meaning":"산","kanji":[{"char":"山","korean":"산","meaning":"메 산","reading":"やま"}],"partOfSpeech":"명사","example":{"jp":"山に登ります。","kr":"산에 오릅니다."},"level":"N5","frequency":5},{"id":"k0106","word":"川","reading":"かわ","romaji":"kawa","meaning":"강","kanji":[{"char":"川","korean":"천","meaning":"내 천","reading":"かわ"}],"partOfSpeech":"명사","example":{"jp":"川で泳ぎます。","kr":"강에서 수영합니다."},"level":"N5","frequency":5},{"id":"k0107","word":"海","reading":"うみ","romaji":"umi","meaning":"바다","kanji":[{"char":"海","korean":"해","meaning":"바다 해","reading":"うみ"}],"partOfSpeech":"명사","example":{"jp":"海に行きたいです。","kr":"바다에 가고 싶습니다."},"level":"N5","frequency":5},{"id":"k0108","word":"食事","reading":"しょくじ","romaji":"shokuji","meaning":"식사","kanji":[{"char":"食","korean":"식","meaning":"먹을 식","reading":"しょく"},{"char":"事","korean":"사","meaning":"일 사","reading":"じ"}],"partOfSpeech":"명사","example":{"jp":"食事をしましょう。","kr":"식사를 합시다."},"level":"N5","frequency":5},{"id":"k0109","word":"朝ごはん","reading":"あさごはん","romaji":"asagohan","meaning":"아침식사","kanji":[{"char":"朝","korean":"조","meaning":"아침 조","reading":"あさ"}],"partOfSpeech":"명사","example":{"jp":"朝ごはんを食べます。","kr":"아침식사를 먹습니다."},"level":"N5","frequency":5},{"id":"k0110","word":"昼ごはん","reading":"ひるごはん","romaji":"hirugohan","meaning":"점심식사","kanji":[{"char":"昼","korean":"주","meaning":"낮 주","reading":"ひる"}],"partOfSpeech":"명사","example":{"jp":"昼ごはんは何を食べますか。","kr":"점심식사는 무엇을 먹습니까?"},"level":"N5","frequency":5},{"id":"k0111","word":"晩ごはん","reading":"ばんごはん","romaji":"bangohan","meaning":"저녁식사","kanji":[{"char":"晩","korean":"만","meaning":"저물 만","reading":"ばん"}],"partOfSpeech":"명사","example":{"jp":"晩ごはんはまだです。","kr":"저녁식사는 아직입니다."},"level":"N5","frequency":5},{"id":"k0112","word":"肉","reading":"にく","romaji":"niku","meaning":"고기","kanji":[{"char":"肉","korean":"육","meaning":"고기 육","reading":"にく"}],"partOfSpeech":"명사","example":{"jp":"肉が好きです。","kr":"고기를 좋아합니다."},"level":"N5","frequency":5},{"id":"k0113","word":"魚","reading":"さかな","romaji":"sakana","meaning":"생선","kanji":[{"char":"魚","korean":"어","meaning":"물고기 어","reading":"さかな"}],"partOfSpeech":"명사","example":{"jp":"魚を食べます。","kr":"생선을 먹습니다."},"level":"N5","frequency":5},{"id":"k0114","word":"野菜","reading":"やさい","romaji":"yasai","meaning":"채소","kanji":[{"char":"野","korean":"야","meaning":"들 야","reading":"や"},{"char":"菜","korean":"채","meaning":"나물 채","reading":"さい"}],"partOfSpeech":"명사","example":{"jp":"野菜は体にいいです。","kr":"채소는 몸에 좋습니다."},"level":"N5","frequency":5},{"id":"k0115","word":"水","reading":"みず","romaji":"mizu","meaning":"물","kanji":[{"char":"水","korean":"수","meaning":"물 수","reading":"みず"}],"partOfSpeech":"명사","example":{"jp":"水を飲んでください。","kr":"물을 마셔주세요."},"level":"N5","frequency":5},{"id":"k0116","word":"朝","reading":"あさ","romaji":"asa","meaning":"아침","kanji":[{"char":"朝","korean":"조","meaning":"아침 조","reading":"あさ"}],"partOfSpeech":"명사","example":{"jp":"朝早く起きます。","kr":"아침 일찍 일어납니다."},"level":"N5","frequency":5},{"id":"k0117","word":"昼","reading":"ひる","romaji":"hiru","meaning":"낮","kanji":[{"char":"昼","korean":"주","meaning":"낮 주","reading":"ひる"}],"partOfSpeech":"명사","example":{"jp":"昼休みです。","kr":"점심시간입니다."},"level":"N5","frequency":5},{"id":"k0118","word":"夜","reading":"よる","romaji":"yoru","meaning":"밤","kanji":[{"char":"夜","korean":"야","meaning":"밤 야","reading":"よる"}],"partOfSpeech":"명사","example":{"jp":"夜遅く帰ります。","kr":"밤늦게 돌아옵니다."},"level":"N5","frequency":5},{"id":"k0119","word":"午前","reading":"ごぜん","romaji":"gozen","meaning":"오전","kanji":[{"char":"午","korean":"오","meaning":"낮 오","reading":"ご"},{"char":"前","korean":"전","meaning":"앞 전","reading":"ぜん"}],"partOfSpeech":"명사","example":{"jp":"午前中に会いましょう。","kr":"오전 중에 만나요."},"level":"N5","frequency":5},{"id":"k0120","word":"午後","reading":"ごご","romaji":"gogo","meaning":"오후","kanji":[{"char":"午","korean":"오","meaning":"낮 오","reading":"ご"},{"char":"後","korean":"후","meaning":"뒤 후","reading":"ご"}],"partOfSpeech":"명사","example":{"jp":"午後は暇です。","kr":"오후는 한가합니다."},"level":"N5","frequency":5},{"id":"k0121","word":"週末","reading":"しゅうまつ","romaji":"shuumatsu","meaning":"주말","kanji":[{"char":"週","korean":"주","meaning":"주 주","reading":"しゅう"},{"char":"末","korean":"말","meaning":"끝 말","reading":"まつ"}],"partOfSpeech":"명사","example":{"jp":"週末は休みます。","kr":"주말은 쉽니다."},"level":"N5","frequency":5},{"id":"k0122","word":"上","reading":"うえ","romaji":"ue","meaning":"위","kanji":[{"char":"上","korean":"상","meaning":"위 상","reading":"うえ"}],"partOfSpeech":"명사","example":{"jp":"机の上にあります。","kr":"책상 위에 있습니다."},"level":"N5","frequency":5},{"id":"k0123","word":"下","reading":"した","romaji":"shita","meaning":"아래","kanji":[{"char":"下","korean":"하","meaning":"아래 하","reading":"した"}],"partOfSpeech":"명사","example":{"jp":"椅子の下にあります。","kr":"의자 아래에 있습니다."},"level":"N5","frequency":5},{"id":"k0124","word":"中","reading":"なか","romaji":"naka","meaning":"안","kanji":[{"char":"中","korean":"중","meaning":"가운데 중","reading":"なか"}],"partOfSpeech":"명사","example":{"jp":"箱の中に入れてください。","kr":"상자 안에 넣어주세요."},"level":"N5","frequency":5},{"id":"k0125","word":"外","reading":"そと","romaji":"soto","meaning":"밖","kanji":[{"char":"外","korean":"외","meaning":"밖 외","reading":"そと"}],"partOfSpeech":"명사","example":{"jp":"外は寒いです。","kr":"밖은 춥습니다."},"level":"N5","frequency":5},{"id":"k0126","word":"前","reading":"まえ","romaji":"mae","meaning":"앞","kanji":[{"char":"前","korean":"전","meaning":"앞 전","reading":"まえ"}],"partOfSpeech":"명사","example":{"jp":"駅の前で待っています。","kr":"역 앞에서 기다리고 있습니다."},"level":"N5","frequency":5},{"id":"k0127","word":"後ろ","reading":"うしろ","romaji":"ushiro","meaning":"뒤","kanji":[{"char":"後","korean":"후","meaning":"뒤 후","reading":"うし"}],"partOfSpeech":"명사","example":{"jp":"後ろを見てください。","kr":"뒤를 봐주세요."},"level":"N5","frequency":5},{"id":"k0128","word":"右","reading":"みぎ","romaji":"migi","meaning":"오른쪽","kanji":[{"char":"右","korean":"우","meaning":"오른 우","reading":"みぎ"}],"partOfSpeech":"명사","example":{"jp":"右に曲がってください。","kr":"오른쪽으로 꺾어주세요."},"level":"N5","frequency":5},{"id":"k0129","word":"左","reading":"ひだり","romaji":"hidari","meaning":"왼쪽","kanji":[{"char":"左","korean":"좌","meaning":"왼 좌","reading":"ひだり"}],"partOfSpeech":"명사","example":{"jp":"左に行ってください。","kr":"왼쪽으로 가주세요."},"level":"N5","frequency":5},{"id":"k0130","word":"東","reading":"ひがし","romaji":"higashi","meaning":"동쪽","kanji":[{"char":"東","korean":"동","meaning":"동녘 동","reading":"ひがし"}],"partOfSpeech":"명사","example":{"jp":"東京は日本の東にあります。","kr":"도쿄는 일본의 동쪽에 있습니다."},"level":"N5","frequency":5},{"id":"k0131","word":"西","reading":"にし","romaji":"nishi","meaning":"서쪽","kanji":[{"char":"西","korean":"서","meaning":"서녘 서","reading":"にし"}],"partOfSpeech":"명사","example":{"jp":"西に行きます。","kr":"서쪽으로 갑니다."},"level":"N5","frequency":5},{"id":"k0132","word":"南","reading":"みなみ","romaji":"minami","meaning":"남쪽","kanji":[{"char":"南","korean":"남","meaning":"남녘 남","reading":"みなみ"}],"partOfSpeech":"명사","example":{"jp":"南の方が暖かいです。","kr":"남쪽이 따뜻합니다."},"level":"N5","frequency":5},{"id":"k0133","word":"北","reading":"きた","romaji":"kita","meaning":"북쪽","kanji":[{"char":"北","korean":"북","meaning":"북녘 북","reading":"きた"}],"partOfSpeech":"명사","example":{"jp":"北海道は北にあります。","kr":"홋카이도는 북쪽에 있습니다."},"level":"N5","frequency":5},{"id":"k0134","word":"国","reading":"くに","romaji":"kuni","meaning":"나라","kanji":[{"char":"国","korean":"국","meaning":"나라 국","reading":"くに"}],"partOfSpeech":"명사","example":{"jp":"どこの国から来ましたか。","kr":"어느 나라에서 왔습니까?"},"level":"N5","frequency":5},{"id":"k0135","word":"外国","reading":"がいこく","romaji":"gaikoku","meaning":"외국","kanji":[{"char":"外","korean":"외","meaning":"밖 외","reading":"がい"},{"char":"国","korean":"국","meaning":"나라 국","reading":"こく"}],"partOfSpeech":"명사","example":{"jp":"外国に行きたいです。","kr":"외국에 가고 싶습니다."},"level":"N5","frequency":5},{"id":"k0136","word":"言葉","reading":"ことば","romaji":"kotoba","meaning":"말","kanji":[{"char":"言","korean":"언","meaning":"말씀 언","reading":"こと"},{"char":"葉","korean":"엽","meaning":"잎 엽","reading":"ば"}],"partOfSpeech":"명사","example":{"jp":"日本語は難しい言葉です。","kr":"일본어는 어려운 언어입니다."},"level":"N5","frequency":5},{"id":"k0137","word":"名前","reading":"なまえ","romaji":"namae","meaning":"이름","kanji":[{"char":"名","korean":"명","meaning":"이름 명","reading":"な"},{"char":"前","korean":"전","meaning":"앞 전","reading":"まえ"}],"partOfSpeech":"명사","example":{"jp":"名前を教えてください。","kr":"이름을 알려주세요."},"level":"N5","frequency":5},{"id":"k0138","word":"物","reading":"もの","romaji":"mono","meaning":"물건","kanji":[{"char":"物","korean":"물","meaning":"물건 물","reading":"もの"}],"partOfSpeech":"명사","example":{"jp":"大切な物です。","kr":"소중한 물건입니다."},"level":"N5","frequency":5},{"id":"k0139","word":"事","reading":"こと","romaji":"koto","meaning":"일","kanji":[{"char":"事","korean":"사","meaning":"일 사","reading":"こと"}],"partOfSpeech":"명사","example":{"jp":"大変なことがありました。","kr":"힘든 일이 있었습니다."},"level":"N5","frequency":5},{"id":"k0140","word":"好き","reading":"すき","romaji":"suki","meaning":"좋아하다","kanji":[{"char":"好","korean":"호","meaning":"좋아할 호","reading":"す"}],"partOfSpeech":"형용사","example":{"jp":"日本語が好きです。","kr":"일본어를 좋아합니다."},"level":"N5","frequency":5},{"id":"k0141","word":"嫌い","reading":"きらい","romaji":"kirai","meaning":"싫어하다","kanji":[{"char":"嫌","korean":"혐","meaning":"싫어할 혐","reading":"きら"}],"partOfSpeech":"형용사","example":{"jp":"野菜が嫌いです。","kr":"채소를 싫어합니다."},"level":"N5","frequency":5},{"id":"k0142","word":"元気","reading":"げんき","romaji":"genki","meaning":"건강하다","kanji":[{"char":"元","korean":"원","meaning":"으뜸 원","reading":"げん"},{"char":"気","korean":"기","meaning":"기운 기","reading":"き"}],"partOfSpeech":"명사","example":{"jp":"元気ですか。","kr":"건강하십니까?"},"level":"N5","frequency":5},{"id":"k0143","word":"忙しい","reading":"いそがしい","romaji":"isogashii","meaning":"바쁘다","kanji":[{"char":"忙","korean":"망","meaning":"바쁠 망","reading":"いそが"}],"partOfSpeech":"형용사","example":{"jp":"今日は忙しいです。","kr":"오늘은 바쁩니다."},"level":"N5","frequency":5},{"id":"k0144","word":"暇","reading":"ひま","romaji":"hima","meaning":"한가하다","kanji":[{"char":"暇","korean":"가","meaning":"겨를 가","reading":"ひま"}],"partOfSpeech":"명사","example":{"jp":"暇な時間がありません。","kr":"한가한 시간이 없습니다."},"level":"N5","frequency":5},{"id":"k0145","word":"世界","reading":"せかい","romaji":"sekai","meaning":"세계","kanji":[{"char":"世","korean":"세","meaning":"인간 세","reading":"せ"},{"char":"界","korean":"계","meaning":"지경 계","reading":"かい"}],"partOfSpeech":"명사","example":{"jp":"世界中を旅行したいです。","kr":"세계 중을 여행하고 싶습니다."},"level":"N5","frequency":5},{"id":"k0146","word":"気持ち","reading":"きもち","romaji":"kimochi","meaning":"기분","kanji":[{"char":"気","korean":"기","meaning":"기운 기","reading":"き"},{"char":"持","korean":"지","meaning":"가질 지","reading":"も"}],"partOfSpeech":"명사","example":{"jp":"気持ちが悪いです。","kr":"기분이 나쁩니다."},"level":"N4","frequency":4},{"id":"k0147","word":"意味","reading":"いみ","romaji":"imi","meaning":"의미","kanji":[{"char":"意","korean":"의","meaning":"뜻 의","reading":"い"},{"char":"味","korean":"미","meaning":"맛 미","reading":"み"}],"partOfSpeech":"명사","example":{"jp":"この言葉の意味は何ですか。","kr":"이 단어의 의미는 무엇입니까?"},"level":"N4","frequency":4},{"id":"k0148","word":"気分","reading":"きぶん","romaji":"kibun","meaning":"기분","kanji":[{"char":"気","korean":"기","meaning":"기운 기","reading":"き"},{"char":"分","korean":"분","meaning":"나눌 분","reading":"ぶん"}],"partOfSpeech":"명사","example":{"jp":"気分が良いです。","kr":"기분이 좋습니다."},"level":"N3","frequency":3},{"id":"k0149","word":"態度","reading":"たいど","romaji":"taido","meaning":"태도","kanji":[{"char":"態","korean":"태","meaning":"모양 태","reading":"たい"},{"char":"度","korean":"도","meaning":"법도 도","reading":"ど"}],"partOfSpeech":"명사","example":{"jp":"態度が悪いです。","kr":"태도가 나쁩니다."},"level":"N3","frequency":3},{"id":"k0150","word":"関心","reading":"かんしん","romaji":"kanshin","meaning":"관심","kanji":[{"char":"関","korean":"관","meaning":"관계 관","reading":"かん"},{"char":"心","korean":"심","meaning":"마음 심","reading":"しん"}],"partOfSpeech":"명사","example":{"jp":"環境問題に関心があります。","kr":"환경 문제에 관심이 있습니다."},"level":"N2","frequency":2},{"id":"k0151","word":"影響","reading":"えいきょう","romaji":"eikyou","meaning":"영향","kanji":[{"char":"影","korean":"영","meaning":"그림자 영","reading":"えい"},{"char":"響","korean":"향","meaning":"울릴 향","reading":"きょう"}],"partOfSpeech":"명사","example":{"jp":"悪い影響を与えます。","kr":"나쁜 영향을 줍니다."},"level":"N2","frequency":2},{"id":"k0152","word":"概念","reading":"がいねん","romaji":"gainen","meaning":"개념","kanji":[{"char":"概","korean":"개","meaning":"대개 개","reading":"がい"},{"char":"念","korean":"념","meaning":"생각 념","reading":"ねん"}],"partOfSpeech":"명사","example":{"jp":"この概念は難しいです。","kr":"이 개념은 어렵습니다."},"level":"N1","frequency":1},{"id":"k0153","word":"本質","reading":"ほんしつ","romaji":"honshitsu","meaning":"본질","kanji":[{"char":"本","korean":"본","meaning":"근본 본","reading":"ほん"},{"char":"質","korean":"질","meaning":"바탕 질","reading":"しつ"}],"partOfSpeech":"명사","example":{"jp":"問題の本質を理解する。","kr":"문제의 본질을 이해한다."},"level":"N1","frequency":1}]};

        // Global variables
        let vocabulary = [];
        let currentMode = '';
        let currentWordIndex = 0;
        let stats = {
            learned: new Set(),
            correct: 0,
            total: 0,
            streak: 0
        };

        // Level and Stage selection
        let selectedLevel = 'N5';
        let selectedStage = 1;
        let stagesMetadata = null;
        let levelData = null;
        let allLevelsData = {};

        // Audio settings
        let audioSettings = {
            engine: 'responsivevoice',
            voiceType: 'Japanese Female',
            rate: 0.85,
            autoPlayExample: true
        };

        // Load stages metadata
        async function loadStagesMetadata() {
            try {
                const response = await fetch('data/vocabulary/stages.json');
                stagesMetadata = await response.json();
                console.log('✅ Stages metadata loaded');
                return stagesMetadata;
            } catch (error) {
                console.error('❌ Failed to load stages metadata:', error);
                return null;
            }
        }

        // Load vocabulary by level
        async function loadLevelData(level) {
            if (allLevelsData[level]) {
                console.log(`✅ Using cached data for ${level}`);
                return allLevelsData[level];
            }

            try {
                const response = await fetch(`data/vocabulary/${level.toLowerCase()}.json`);
                const data = await response.json();
                allLevelsData[level] = data;
                console.log(`✅ Loaded ${level}: ${data.totalWords} words`);
                return data;
            } catch (error) {
                console.error(`❌ Failed to load ${level} data:`, error);
                // Fallback to embedded data if external load fails
                const fallbackWords = VOCABULARY_DATA.words.filter(w => w.level === level);
                return {
                    level: level,
                    totalWords: fallbackWords.length,
                    words: fallbackWords
                };
            }
        }

        // Load vocabulary data (fallback to embedded data)
        async function loadVocabulary() {
            // 🔥 CRITICAL: Reset vocabulary to empty array at start
            vocabulary = [];

            console.log(`🔍 Loading vocabulary: Level=${selectedLevel}, Stage=${selectedStage}`);

            try {
                // Try loading from external files
                await loadStagesMetadata();
                levelData = await loadLevelData(selectedLevel);

                // Filter by stage
                if (levelData && levelData.words) {
                    const filteredWords = levelData.words.filter(w => w.stage === selectedStage);

                    console.log(`🔍 Total words in ${selectedLevel}: ${levelData.words.length}`);
                    console.log(`🔍 Words with stage=${selectedStage}: ${filteredWords.length}`);

                    if (filteredWords.length === 0) {
                        console.error(`❌ No words found for ${selectedLevel} Stage ${selectedStage}!`);
                        console.error(`Available stages:`, [...new Set(levelData.words.map(w => w.stage))].sort());
                    } else {
                        vocabulary = filteredWords;
                        console.log(`✅ Loaded ${vocabulary.length} words (${selectedLevel} Stage ${selectedStage})`);
                        console.log(`First word:`, vocabulary[0]);
                    }
                } else {
                    console.error('❌ No levelData or words available');
                }
            } catch (error) {
                console.error('❌ Error loading vocabulary:', error);
                // Fallback to embedded data
                vocabulary = VOCABULARY_DATA.words.filter(w => w.level === selectedLevel);
                console.log(`📚 Using fallback data: ${vocabulary.length} words`);
            }

            // Only shuffle if we have words
            if (vocabulary.length > 0) {
                shuffleArray(vocabulary);
                console.log(`✅ Shuffled ${vocabulary.length} words`);
            } else {
                console.error(`❌ Cannot shuffle: vocabulary is empty!`);
            }
        }

        // Select level and load stages
        async function selectLevel(level) {
            console.log(`🎯 Level button clicked: ${level}`);

            selectedLevel = level;
            selectedStage = 1; // Reset to stage 1

            // 🔥 CRITICAL: Clear vocabulary immediately
            vocabulary = [];
            console.log(`🧹 Cleared vocabulary array`);

            // Update level button states with color themes
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('level-n5', 'level-n4', 'level-n3', 'level-n2', 'level-n1', 'active');
            });

            const selectedBtn = document.getElementById(`level-${level}`);
            if (selectedBtn) {
                selectedBtn.classList.add(`level-${level.toLowerCase()}`, 'active');
            }

            // Update status UI immediately (before loading)
            updateVocabularyStatus();

            // Load level data
            levelData = await loadLevelData(level);

            // Generate stage buttons
            renderStageButtons();

            // Load vocabulary for stage 1
            await loadVocabulary();

            // Update status UI again (after loading)
            updateVocabularyStatus();

            console.log(`✅ Level selected: ${level} Stage ${selectedStage} - ${vocabulary.length} words`);
        }

        // Render stage buttons for selected level
        function renderStageButtons() {
            const stageButtonsContainer = document.getElementById('stage-buttons');
            if (!stageButtonsContainer) {
                console.log('⚠️ Stage buttons container not found');
                return;
            }

            stageButtonsContainer.innerHTML = '';

            // 레벨별 기본 스테이지 수 (폴백)
            const defaultStages = {
                'N5': 5,
                'N4': 10,
                'N3': 10,
                'N2': 12,
                'N1': 10
            };

            let stages = [];

            if (stagesMetadata && stagesMetadata.levels && stagesMetadata.levels[selectedLevel]) {
                // Use metadata if available
                stages = stagesMetadata.levels[selectedLevel].stages;
            } else {
                // Fallback: create default stages
                const numStages = defaultStages[selectedLevel] || 5;
                for (let i = 1; i <= numStages; i++) {
                    stages.push({
                        stageNumber: i,
                        name: `Stage ${i}`,
                        wordCount: 30
                    });
                }
                console.log(`⚠️ Using fallback: ${numStages} stages for ${selectedLevel}`);
            }

            // 스테이지 버튼 생성
            stages.forEach(stageInfo => {
                const stageNum = stageInfo.stageNumber;
                const wordCount = stageInfo.wordCount || 30;

                const btn = document.createElement('button');
                btn.innerHTML = `S${stageNum} <small style="font-size: 0.85em; opacity: 0.7;">(${wordCount})</small>`;
                btn.title = stageInfo.name || `${wordCount}개 단어`;
                btn.className = 'stage-btn';
                btn.onclick = () => selectStage(stageNum);

                if (stageNum === selectedStage) {
                    btn.classList.add('active');
                }

                stageButtonsContainer.appendChild(btn);
            });

            console.log(`✅ Rendered ${stages.length} stage buttons for ${selectedLevel}`);
        }

        // Select stage and reload vocabulary
        async function selectStage(stageNum) {
            console.log(`🎯 Stage button clicked: ${stageNum}`);
            console.log(`🎯 Before: Level=${selectedLevel}, Stage=${selectedStage}, Words=${vocabulary.length}`);

            // Update selected stage
            selectedStage = stageNum;

            // 🔥 CRITICAL: Clear existing vocabulary before loading
            vocabulary = [];
            console.log(`🧹 Cleared vocabulary array`);

            // Update status UI immediately (before loading)
            updateVocabularyStatus();

            // Load vocabulary for this stage
            await loadVocabulary();

            // Update status UI again (after loading)
            updateVocabularyStatus();

            // Verify we have words loaded
            if (vocabulary.length === 0) {
                console.error(`❌ CRITICAL: No words loaded for ${selectedLevel} Stage ${selectedStage}!`);
                alert(`単語データが見つかりません。\nレベル: ${selectedLevel}\nステージ: ${selectedStage}\n\nコンソールを確認してください。`);
                return;
            }

            console.log(`✅ After: Level=${selectedLevel}, Stage=${selectedStage}, Words=${vocabulary.length}`);
            console.log(`✅ First 3 words:`, vocabulary.slice(0, 3).map(w => w.word));

            // Update stage button states
            renderStageButtons();

            // If in a game mode, reload the mode
            if (currentMode) {
                console.log(`🔄 Reloading ${currentMode} with new vocabulary`);
                startMode(currentMode);
            }
        }

        // Update vocabulary status UI
        function updateVocabularyStatus() {
            const statusLevelStage = document.getElementById('status-level-stage');
            const statusWordCount = document.getElementById('status-word-count');
            const statusWordPreview = document.getElementById('status-word-preview');

            if (!statusLevelStage || !statusWordCount || !statusWordPreview) {
                console.warn('⚠️ Status UI elements not found');
                return;
            }

            // Update level and stage
            statusLevelStage.textContent = `${selectedLevel} Stage ${selectedStage}`;

            // Update word count
            const wordCount = vocabulary.length;
            statusWordCount.textContent = `${wordCount}個`;
            statusWordCount.style.color = wordCount === 0 ? '#e53e3e' : '#38a169';

            // Update word preview
            if (wordCount === 0) {
                statusWordPreview.textContent = '⚠️ 単語なし';
                statusWordPreview.style.color = '#e53e3e';
            } else {
                const preview = vocabulary.slice(0, 3).map(w => w.word).join(' / ');
                const more = wordCount > 3 ? ` (+${wordCount - 3})` : '';
                statusWordPreview.textContent = `${preview}${more}`;
                statusWordPreview.style.color = '#2d3748';
            }

            console.log(`✅ Status updated: ${selectedLevel} Stage ${selectedStage} - ${wordCount} words`);
        }

        // Initialize app on page load
        async function initializeApp() {
            console.log('🚀 Initializing app...');

            // Load metadata and initial data
            await loadStagesMetadata();
            await selectLevel('N5'); // Default to N5 Stage 1 (will call loadVocabulary internally)

            // Update status UI (redundant but safe)
            updateVocabularyStatus();

            console.log('✅ App initialized');
            console.log(`📊 Initial state: ${selectedLevel} Stage ${selectedStage} - ${vocabulary.length} words`);
        }

        // Utility functions
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Enhanced speak function with ResponsiveVoice.js
        let isSpeaking = false;

        function speak(text, lang = 'ja-JP') {
            if (isSpeaking) {
                stopSpeaking();
                return;
            }

            isSpeaking = true;

            // Use ResponsiveVoice if selected and available
            if (audioSettings.engine === 'responsivevoice' && typeof responsiveVoice !== 'undefined') {
                const voice = lang.startsWith('ja') ? audioSettings.voiceType : 'Korean Female';
                responsiveVoice.speak(text, voice, {
                    rate: audioSettings.rate,
                    pitch: 1.0,
                    onend: () => {
                        isSpeaking = false;
                    },
                    onerror: () => {
                        isSpeaking = false;
                        // Fallback to Web Speech API
                        speakWithWebAPI(text, lang);
                    }
                });
            } else {
                // Use Web Speech API
                speakWithWebAPI(text, lang);
            }
        }

        function speakWithWebAPI(text, lang) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang;
                utterance.rate = audioSettings.rate;
                utterance.onend = () => {
                    isSpeaking = false;
                };
                speechSynthesis.speak(utterance);
            } else {
                isSpeaking = false;
            }
        }

        function stopSpeaking() {
            if (typeof responsiveVoice !== 'undefined') {
                responsiveVoice.cancel();
            }
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
            }
            isSpeaking = false;
        }

        function updateStats() {
            document.getElementById('learned-count').textContent = stats.learned.size;
            const accuracy = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('streak').textContent = stats.streak;
        }

        function showModeSelection() {
            document.getElementById('mode-selection').style.display = 'block';
            document.getElementById('game-area').classList.remove('active');
            // 헤더 다시 표시
            const header = document.getElementById('main-header');
            if (header) header.style.display = 'block';
        }

        function hideModeSelection() {
            document.getElementById('mode-selection').style.display = 'none';
            document.getElementById('game-area').classList.add('active');
            // 헤더 숨기기
            const header = document.getElementById('main-header');
            if (header) header.style.display = 'none';
        }

        // Go to home (mode selection)
        function goHome() {
            // Stop any ongoing audio
            stopSpeaking();

            // Reset auto-study state
            if (autoStudyState) {
                autoStudyState.isPlaying = false;
                autoStudyState.isPaused = false;
            }

            // Reset current mode
            currentMode = null;

            // Show mode selection
            showModeSelection();
        }

        // Start specific game mode
        async function startMode(mode) {
            console.log(`🎮 startMode called: ${mode}`);
            console.log(`🎮 Current state: Level=${selectedLevel}, Stage=${selectedStage}, Vocabulary=${vocabulary.length} words`);

            currentMode = mode;
            currentWordIndex = 0;

            // Ensure vocabulary is loaded
            if (!vocabulary || vocabulary.length === 0) {
                console.warn('⚠️ Vocabulary not loaded, loading now...');
                console.warn(`⚠️ State: Level=${selectedLevel}, Stage=${selectedStage}`);
                await loadVocabulary();
            }

            if (!vocabulary || vocabulary.length === 0) {
                console.error('❌ CRITICAL: Failed to load vocabulary!');
                console.error(`❌ Final state: Level=${selectedLevel}, Stage=${selectedStage}, Vocabulary=${vocabulary.length}`);
                alert(`単語を読み込めません。\n\nレベル: ${selectedLevel}\nステージ: ${selectedStage}\n\nレベルとステージを選択してください。`);
                showModeSelection();
                return;
            }

            console.log(`✅ Starting flashcard with ${vocabulary.length} words`);
            console.log(`✅ First word: ${vocabulary[0]?.word || 'N/A'}`);

            // Update status UI one more time before starting mode
            updateVocabularyStatus();

            hideModeSelection();

            switch(mode) {
                case 'auto-study':
                    startAutoStudyMode();
                    break;
                case 'flashcard':
                    startFlashcardMode();
                    break;
                case 'multiple-choice':
                    startMultipleChoiceMode();
                    break;
                case 'listening':
                    startListeningMode();
                    break;
                case 'typing':
                    startTypingMode();
                    break;
                case 'matching':
                    startMatchingMode();
                    break;
                case 'speed':
                    startSpeedMode();
                    break;
            }
        }

        // Flashcard Mode
        function startFlashcardMode() {
            showFlashcard();
        }

        function showFlashcard() {
            // Safety check: verify vocabulary is loaded
            if (!vocabulary || vocabulary.length === 0) {
                console.error('❌ showFlashcard: vocabulary is empty!');
                console.error(`❌ Current state: Level=${selectedLevel}, Stage=${selectedStage}`);
                document.getElementById('game-area').innerHTML = `
                    <button class="back-btn" onclick="showModeSelection()">← モード選択</button>
                    <div style="text-align: center; padding: 40px; background: #fff3cd; border-radius: 10px; margin: 20px;">
                        <h2 style="color: #856404;">⚠️ データエラー</h2>
                        <p style="color: #856404; margin: 20px 0;">単語データが読み込まれていません。</p>
                        <p style="color: #856404;">レベル: ${selectedLevel} / ステージ: ${selectedStage}</p>
                        <button onclick="window.location.reload()" style="margin-top: 20px; padding: 10px 20px;">
                            ページを再読み込み
                        </button>
                    </div>
                `;
                return;
            }

            if (currentWordIndex >= vocabulary.length) {
                currentWordIndex = 0;
                shuffleArray(vocabulary);
            }

            const word = vocabulary[currentWordIndex];

            if (!word) {
                console.error(`❌ showFlashcard: word not found at index ${currentWordIndex}`);
                return;
            }

            console.log(`📖 Showing flashcard ${currentWordIndex + 1}/${vocabulary.length}: ${word.word}`);
            const kanjiList = word.kanji.map(k => `${k.char} (${k.korean}: ${k.meaning})`).join(', ');

            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="showModeSelection()">← 모드 선택</button>
                <div class="flashcard-container">
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="card-face card-front">
                            <div class="kanji-word">${word.word}</div>
                            <div class="reading">${word.reading}</div>
                            <div class="romaji">${word.romaji}</div>
                        </div>
                        <div class="card-face card-back">
                            <div class="meaning">${word.meaning}</div>
                            <div class="hanja-info">한자: ${kanjiList}</div>
                            <div class="example">
                                <div id="example-jp">${word.example.jp}</div>
                                <div style="color: #4A90E2; margin-top: 5px;">${word.example.kr}</div>
                                <button class="audio-btn" onclick="event.stopPropagation(); playExample('${word.example.jp}')" style="margin-top: 10px; padding: 10px 20px; font-size: 1em;">
                                    🔊 예문 듣기
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <button class="audio-btn" onclick="playCurrentWord()">🔊 소리 듣기</button>
                </div>
                <div class="control-btns">
                    <button class="control-btn dont-know-btn" onclick="markAnswer(false)">몰라요 ←</button>
                    <button class="control-btn know-btn" onclick="markAnswer(true)">알아요 →</button>
                </div>
                <div class="keyboard-hint">
                    <strong>키보드:</strong> Space (뒤집기) | ← (몰라요) | → (알아요) | S (소리)<br>
                    <small>💡 뒤집으면 자동 재생: 의미(한) → 예문(일) → 예문해석(한)</small>
                </div>
            `;

            setTimeout(() => speak(word.word), 300);
        }

        function flipCard() {
            const card = document.getElementById('flashcard');
            card.classList.toggle('flip');

            // Play meaning, example, and translation when flipping to the back (if enabled)
            if (card.classList.contains('flip') && audioSettings.autoPlayExample) {
                const word = vocabulary[currentWordIndex];
                setTimeout(() => {
                    // Step 1: Play meaning (Korean)
                    speak(word.meaning, 'ko-KR');

                    // Step 2: Play example (Japanese)
                    setTimeout(() => {
                        speak(word.example.jp, 'ja-JP');

                        // Step 3: Play example translation (Korean)
                        setTimeout(() => {
                            speak(word.example.kr, 'ko-KR');
                        }, 2500);
                    }, 1500);
                }, 600); // Wait for flip animation to complete
            }
        }

        // Audio settings functions
        function toggleAudioSettings() {
            const panel = document.getElementById('audio-settings');
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
            } else {
                panel.style.display = 'none';
            }
        }

        function updateAudioSettings() {
            audioSettings.engine = document.getElementById('audio-engine').value;
            audioSettings.voiceType = document.getElementById('voice-type').value;
            audioSettings.rate = parseFloat(document.getElementById('audio-rate').value);
            audioSettings.autoPlayExample = document.getElementById('auto-play-example').checked;

            // Update rate display
            document.getElementById('rate-value').textContent = audioSettings.rate.toFixed(2);
        }

        function playCurrentWord() {
            const word = vocabulary[currentWordIndex];
            speak(word.word);
        }

        function playExample(exampleText) {
            speak(exampleText, 'ja-JP');
        }

        function markAnswer(isCorrect) {
            const word = vocabulary[currentWordIndex];
            stats.learned.add(word.id);
            stats.total++;
            if (isCorrect) {
                stats.correct++;
                stats.streak++;
            } else {
                stats.streak = 0;
            }
            updateStats();
            currentWordIndex++;
            showFlashcard();
        }

        // Multiple Choice Mode
        function startMultipleChoiceMode() {
            showMultipleChoice();
        }

        function showMultipleChoice() {
            if (currentWordIndex >= vocabulary.length) {
                currentWordIndex = 0;
                shuffleArray(vocabulary);
            }

            const word = vocabulary[currentWordIndex];
            const choices = generateChoices(word);

            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="showModeSelection()">← 모드 선택</button>
                <div class="question-container">
                    <h2>이 단어의 뜻은?</h2>
                    <div class="question-word">${word.word}</div>
                    <div class="question-reading">${word.reading} (${word.romaji})</div>
                    <button class="audio-btn" onclick="speak('${word.word}')">🔊 듣기</button>
                    <div class="choices" id="choices">
                        ${choices.map((choice, idx) => `
                            <button class="choice-btn" onclick="checkAnswer(${idx}, ${choice.correct})">${choice.meaning}</button>
                        `).join('')}
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(currentWordIndex / vocabulary.length) * 100}%"></div>
                    </div>
                </div>
            `;

            setTimeout(() => speak(word.word), 300);
        }

        function generateChoices(correctWord) {
            const choices = [{ meaning: correctWord.meaning, correct: true }];
            const wrongChoices = vocabulary
                .filter(w => w.id !== correctWord.id)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(w => ({ meaning: w.meaning, correct: false }));

            choices.push(...wrongChoices);
            shuffleArray(choices);
            return choices;
        }

        function checkAnswer(choiceIdx, isCorrect) {
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => btn.disabled = true);

            const word = vocabulary[currentWordIndex];

            if (isCorrect) {
                buttons[choiceIdx].classList.add('correct');
                stats.correct++;
                stats.streak++;
                stats.learned.add(word.id);
            } else {
                buttons[choiceIdx].classList.add('wrong');
                stats.streak = 0;
            }

            stats.total++;
            updateStats();

            setTimeout(() => {
                currentWordIndex++;
                showMultipleChoice();
            }, 1500);
        }

        // Listening Mode
        function startListeningMode() {
            showListeningQuestion();
        }

        function showListeningQuestion() {
            if (currentWordIndex >= vocabulary.length) {
                currentWordIndex = 0;
                shuffleArray(vocabulary);
            }

            const word = vocabulary[currentWordIndex];
            const choices = generateChoices(word);

            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="showModeSelection()">← 모드 선택</button>
                <div class="listening-container">
                    <h2>듣고 의미를 고르세요</h2>
                    <button class="play-audio-btn" onclick="speak('${word.word}')">▶️</button>
                    <p style="font-size: 1.2em; color: #666;">위 버튼을 클릭하여 소리를 들어보세요</p>
                    <div class="choices" id="choices">
                        ${choices.map((choice, idx) => `
                            <button class="choice-btn" onclick="checkListeningAnswer(${idx}, ${choice.correct}, '${word.word}', '${word.reading}')">${choice.meaning}</button>
                        `).join('')}
                    </div>
                </div>
            `;

            setTimeout(() => speak(word.word), 500);
        }

        function checkListeningAnswer(choiceIdx, isCorrect, wordText, reading) {
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => btn.disabled = true);

            if (isCorrect) {
                buttons[choiceIdx].classList.add('correct');
                stats.correct++;
                stats.streak++;
                const word = vocabulary[currentWordIndex];
                stats.learned.add(word.id);
            } else {
                buttons[choiceIdx].classList.add('wrong');
                stats.streak = 0;
            }

            stats.total++;
            updateStats();

            setTimeout(() => {
                alert(`정답: ${wordText} (${reading})`);
                currentWordIndex++;
                showListeningQuestion();
            }, 1000);
        }

        // Typing Mode
        function startTypingMode() {
            showTypingQuestion();
        }

        function showTypingQuestion() {
            if (currentWordIndex >= vocabulary.length) {
                currentWordIndex = 0;
                shuffleArray(vocabulary);
            }

            const word = vocabulary[currentWordIndex];

            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="showModeSelection()">← 모드 선택</button>
                <div class="typing-container">
                    <h2>일본어 읽기를 입력하세요</h2>
                    <div class="typing-word">${word.word}</div>
                    <div class="typing-hint">의미: ${word.meaning}</div>
                    <button class="audio-btn" onclick="speak('${word.word}')">🔊 듣기</button>
                    <input type="text" class="typing-input" id="typing-input" placeholder="히라가나로 입력..." autofocus>
                    <button class="submit-btn" onclick="checkTypingAnswer('${word.reading}')">확인</button>
                    <div class="keyboard-hint">
                        <strong>힌트:</strong> ${word.romaji}
                    </div>
                </div>
            `;

            document.getElementById('typing-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkTypingAnswer(word.reading);
                }
            });

            setTimeout(() => speak(word.word), 300);
        }

        function checkTypingAnswer(correctReading) {
            const input = document.getElementById('typing-input').value.trim();
            const isCorrect = input === correctReading;

            if (isCorrect) {
                alert('정답입니다! ✅');
                stats.correct++;
                stats.streak++;
                const word = vocabulary[currentWordIndex];
                stats.learned.add(word.id);
            } else {
                alert(`틀렸습니다. 정답: ${correctReading}`);
                stats.streak = 0;
            }

            stats.total++;
            updateStats();
            currentWordIndex++;
            showTypingQuestion();
        }

        // Matching Mode
        let matchingSelected = null;
        let matchingWords = [];
        let matchingMeanings = [];
        let matchedPairs = new Set();

        function startMatchingMode() {
            matchingSelected = null;
            matchedPairs = new Set();

            matchingWords = vocabulary.slice(0, 6);
            matchingMeanings = [...matchingWords];
            shuffleArray(matchingMeanings);

            showMatchingGame();
        }

        function showMatchingGame() {
            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="showModeSelection()">← 모드 선택</button>
                <div class="matching-container">
                    <h2>일본어와 한국어 의미를 연결하세요</h2>
                    <div class="matching-grid">
                        <div class="matching-column">
                            <h3>일본어</h3>
                            ${matchingWords.map((word, idx) => `
                                <div class="matching-item" id="word-${idx}" onclick="selectWord(${idx}, 'word')">
                                    ${word.word}<br>
                                    <small>${word.reading}</small>
                                </div>
                            `).join('')}
                        </div>
                        <div class="matching-column">
                            <h3>한국어</h3>
                            ${matchingMeanings.map((word, idx) => `
                                <div class="matching-item" id="meaning-${idx}" onclick="selectWord(${idx}, 'meaning')">
                                    ${word.meaning}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function selectWord(idx, type) {
            const element = document.getElementById(`${type}-${idx}`);

            if (element.classList.contains('matched')) {
                return;
            }

            if (matchingSelected === null) {
                matchingSelected = { idx, type };
                element.classList.add('selected');
            } else {
                if (matchingSelected.type === type) {
                    document.getElementById(`${matchingSelected.type}-${matchingSelected.idx}`).classList.remove('selected');
                    matchingSelected = { idx, type };
                    element.classList.add('selected');
                } else {
                    const wordIdx = matchingSelected.type === 'word' ? matchingSelected.idx : idx;
                    const meaningIdx = matchingSelected.type === 'meaning' ? matchingSelected.idx : idx;

                    if (matchingWords[wordIdx].id === matchingMeanings[meaningIdx].id) {
                        document.getElementById(`word-${wordIdx}`).classList.add('matched');
                        document.getElementById(`meaning-${meaningIdx}`).classList.add('matched');
                        matchedPairs.add(wordIdx);
                        stats.correct++;
                        stats.streak++;
                        stats.learned.add(matchingWords[wordIdx].id);

                        if (matchedPairs.size === matchingWords.length) {
                            setTimeout(() => {
                                alert('모두 완료했습니다! 🎉');
                                startMatchingMode();
                            }, 500);
                        }
                    } else {
                        stats.streak = 0;
                        setTimeout(() => {
                            document.getElementById(`${matchingSelected.type}-${matchingSelected.idx}`).classList.remove('selected');
                        }, 300);
                    }

                    stats.total++;
                    updateStats();
                    matchingSelected = null;
                }
            }
        }

        // Speed Quiz Mode
        let speedTimer = null;
        let speedTimeLeft = 60;
        let speedScore = 0;
        let speedQuestions = 0;

        function startSpeedMode() {
            speedTimeLeft = 60;
            speedScore = 0;
            speedQuestions = 0;
            currentWordIndex = 0;
            shuffleArray(vocabulary);

            speedTimer = setInterval(updateSpeedTimer, 1000);
            showSpeedQuestion();
        }

        function updateSpeedTimer() {
            speedTimeLeft--;
            document.querySelector('.timer').textContent = `⏱️ ${speedTimeLeft}초`;
            if (speedTimeLeft <= 0) {
                endSpeedMode();
            }
        }

        function showSpeedQuestion() {
            if (currentWordIndex >= vocabulary.length) {
                currentWordIndex = 0;
                shuffleArray(vocabulary);
            }

            const word = vocabulary[currentWordIndex];
            const choices = generateChoices(word);

            document.getElementById('game-area').innerHTML = `
                <button class="back-btn" onclick="endSpeedMode()">← 그만하기</button>
                <div class="speed-container">
                    <h2>⚡ 스피드 퀴즈</h2>
                    <div class="timer">⏱️ ${speedTimeLeft}초</div>
                    <div class="score">점수: ${speedScore}</div>
                    <div class="question-word">${word.word}</div>
                    <div class="question-reading">${word.reading}</div>
                    <div class="choices" id="choices">
                        ${choices.map((choice, idx) => `
                            <button class="choice-btn" onclick="checkSpeedAnswer(${idx}, ${choice.correct})">${choice.meaning}</button>
                        `).join('')}
                    </div>
                    <div style="margin-top: 20px; font-size: 1.2em; color: #666;">
                        문제 ${speedQuestions + 1}
                    </div>
                </div>
            `;

            speak(word.word);
        }

        function checkSpeedAnswer(choiceIdx, isCorrect) {
            speedQuestions++;

            if (isCorrect) {
                speedScore += 10;
                stats.correct++;
                stats.streak++;
                const word = vocabulary[currentWordIndex];
                stats.learned.add(word.id);
            } else {
                speedScore = Math.max(0, speedScore - 5);
                stats.streak = 0;
            }

            stats.total++;
            updateStats();
            currentWordIndex++;
            showSpeedQuestion();
        }

        function endSpeedMode() {
            clearInterval(speedTimer);

            const accuracy = speedQuestions > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;

            document.getElementById('game-area').innerHTML = `
                <div class="result-screen">
                    <h2>게임 종료!</h2>
                    <div class="result-stats">
                        <div class="result-stat">
                            <div class="label">최종 점수</div>
                            <div class="value">${speedScore}</div>
                        </div>
                        <div class="result-stat">
                            <div class="label">문제 수</div>
                            <div class="value">${speedQuestions}</div>
                        </div>
                        <div class="result-stat">
                            <div class="label">정답률</div>
                            <div class="value">${accuracy}%</div>
                        </div>
                    </div>
                    <button class="control-btn know-btn" onclick="startSpeedMode()" style="margin: 20px 10px;">다시 하기</button>
                    <button class="control-btn dont-know-btn" onclick="showModeSelection()" style="margin: 20px 10px;">모드 선택</button>
                </div>
            `;
        }

        // Auto Study Mode
        let autoStudyState = {
            isPlaying: false,
            isPaused: false,
            currentStep: 'word', // 'word', 'meaning', 'example'
            delayBetweenCards: 1500, // ms
            delayBetweenSteps: 800 // ms
        };

        function startAutoStudyMode() {
            autoStudyState.isPlaying = false;
            autoStudyState.isPaused = false;

            // Check if there's saved progress
            const savedProgress = localStorage.getItem('autoStudyProgress');
            if (savedProgress) {
                const progress = parseInt(savedProgress);
                if (progress > 0 && progress < vocabulary.length) {
                    // Show resume option
                    showAutoStudyResumeOption(progress);
                    return;
                }
            }

            currentWordIndex = 0;
            showAutoStudyCard();
        }

        function showAutoStudyResumeOption(savedIndex) {
            document.getElementById('game-area').innerHTML = `
                <div class="auto-study-container" style="justify-content: center;">
                    <div style="text-align: center; max-width: 600px;">
                        <h2 style="margin-bottom: var(--space-6); color: var(--primary); font-size: var(--text-3xl);">🎓 자동 학습</h2>
                        <p style="font-size: var(--text-xl); margin-bottom: var(--space-8); color: var(--gray-700);">
                            ${savedIndex + 1}번째 단어까지 학습했습니다
                        </p>
                        <div style="display: flex; gap: var(--space-4); justify-content: center; flex-wrap: wrap;">
                            <button class="auto-study-btn play-pause-btn" onclick="resumeAutoStudy(${savedIndex})" style="padding: var(--space-4) var(--space-8); font-size: var(--text-lg);">
                                ▶️ 이어하기
                            </button>
                            <button class="auto-study-btn" onclick="startAutoStudyFromBeginning()" style="background: var(--gray-600); color: white; padding: var(--space-4) var(--space-8); font-size: var(--text-lg);">
                                🔄 처음부터
                            </button>
                            <button class="auto-study-btn stop-btn" onclick="showModeSelection()" style="padding: var(--space-4) var(--space-8); font-size: var(--text-lg);">
                                ← 돌아가기
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function resumeAutoStudy(index) {
            currentWordIndex = index;
            showAutoStudyCard();
        }

        function startAutoStudyFromBeginning() {
            currentWordIndex = 0;
            localStorage.removeItem('autoStudyProgress');
            showAutoStudyCard();
        }

        function showAutoStudyCard() {
            if (currentWordIndex >= vocabulary.length) {
                showAutoStudyComplete();
                return;
            }

            const word = vocabulary[currentWordIndex];
            const kanjiList = word.kanji.map(k => `${k.char} (${k.korean}: ${k.meaning})`).join(', ');
            const progress = `${currentWordIndex + 1} / ${vocabulary.length}`;

            document.getElementById('game-area').innerHTML = `
                <div class="auto-study-container">
                    <div class="auto-study-progress">${progress}</div>

                    <div class="auto-study-controls">
                        <button class="auto-study-btn play-pause-btn" id="play-pause-btn" onclick="toggleAutoStudy()">
                            ▶️ 재생
                        </button>
                        <button class="auto-study-btn" onclick="jumpToRandom()" style="background: var(--warning); color: white;">
                            🎲 랜덤
                        </button>
                        <input type="number" id="jump-input" min="1" max="${vocabulary.length}" value="${currentWordIndex + 1}"
                            style="width: 70px; padding: var(--space-2); border: 2px solid var(--gray-300); border-radius: var(--radius-md); text-align: center; font-size: var(--text-sm);">
                        <button class="auto-study-btn" onclick="jumpToCard()" style="background: var(--gray-600); color: white;">
                            이동
                        </button>
                        <button class="auto-study-btn stop-btn" onclick="stopAutoStudy()">
                            ■ 정지
                        </button>
                        <button class="auto-study-btn" onclick="goHome()" style="background: var(--info); color: white;">
                            🏠 홈
                        </button>
                    </div>

                    <div class="auto-study-card">
                        <div class="auto-study-word">${word.word}</div>
                        <div class="auto-study-reading">${word.reading} (${word.romaji})</div>
                        <div class="auto-study-meaning">${word.meaning}</div>
                        <div style="font-size: var(--text-base); color: var(--gray-600); margin: var(--space-2) 0;">
                            ${kanjiList}
                        </div>
                        <div class="auto-study-example">
                            <div style="font-size: 1.2em; margin-bottom: var(--space-2); font-weight: 500;">${word.example.jp}</div>
                            <div style="color: var(--primary); font-weight: 500;">${word.example.kr}</div>
                        </div>
                    </div>

                    <div class="auto-study-status" id="auto-study-status"></div>
                </div>
            `;

            // Save progress
            localStorage.setItem('autoStudyProgress', currentWordIndex);
        }

        function toggleAutoStudy() {
            if (!autoStudyState.isPlaying) {
                startAutoStudyPlayback();
            } else {
                if (autoStudyState.isPaused) {
                    resumeAutoStudyPlayback();
                } else {
                    pauseAutoStudy();
                }
            }
        }

        function startAutoStudyPlayback() {
            autoStudyState.isPlaying = true;
            autoStudyState.isPaused = false;

            const btn = document.getElementById('play-pause-btn');
            btn.textContent = '⏸️ 일시정지';
            btn.classList.remove('paused');

            playAutoStudySequence();
        }

        function pauseAutoStudy() {
            autoStudyState.isPaused = true;
            stopSpeaking();

            const btn = document.getElementById('play-pause-btn');
            btn.textContent = '▶️ 재개';
            btn.classList.add('paused');

            updateAutoStudyStatus('일시정지됨');
        }

        function resumeAutoStudyPlayback() {
            autoStudyState.isPaused = false;

            const btn = document.getElementById('play-pause-btn');
            btn.textContent = '⏸️ 일시정지';
            btn.classList.remove('paused');

            playAutoStudySequence();
        }

        function stopAutoStudy() {
            autoStudyState.isPlaying = false;
            autoStudyState.isPaused = false;
            stopSpeaking();
            showModeSelection();
        }

        function jumpToRandom() {
            stopSpeaking();
            autoStudyState.isPlaying = false;
            autoStudyState.isPaused = false;
            currentWordIndex = Math.floor(Math.random() * vocabulary.length);
            showAutoStudyCard();
        }

        function jumpToCard() {
            const input = document.getElementById('jump-input');
            const targetIndex = parseInt(input.value) - 1;

            if (targetIndex >= 0 && targetIndex < vocabulary.length) {
                stopSpeaking();
                autoStudyState.isPlaying = false;
                autoStudyState.isPaused = false;
                currentWordIndex = targetIndex;
                showAutoStudyCard();
            } else {
                alert(`1부터 ${vocabulary.length} 사이의 숫자를 입력하세요.`);
            }
        }

        function playAutoStudySequence() {
            if (!autoStudyState.isPlaying || autoStudyState.isPaused) {
                return;
            }

            if (currentWordIndex >= vocabulary.length) {
                showAutoStudyComplete();
                return;
            }

            const word = vocabulary[currentWordIndex];

            // Step 1: Play word (Japanese)
            updateAutoStudyStatus('🔊 단어 읽는 중...');
            speak(word.word, 'ja-JP');

            setTimeout(() => {
                if (!autoStudyState.isPlaying || autoStudyState.isPaused) return;

                // Step 2: Play meaning (Korean)
                updateAutoStudyStatus('🔊 의미 읽는 중...');
                speak(word.meaning, 'ko-KR');

                setTimeout(() => {
                    if (!autoStudyState.isPlaying || autoStudyState.isPaused) return;

                    // Step 3: Play example (Japanese)
                    updateAutoStudyStatus('🔊 예문 읽는 중...');
                    speak(word.example.jp, 'ja-JP');

                    setTimeout(() => {
                        if (!autoStudyState.isPlaying || autoStudyState.isPaused) return;

                        // Step 4: Play example translation (Korean)
                        updateAutoStudyStatus('🔊 예문 해석 읽는 중...');
                        speak(word.example.kr, 'ko-KR');

                        setTimeout(() => {
                            if (!autoStudyState.isPlaying || autoStudyState.isPaused) return;

                            // Move to next card
                            stats.learned.add(word.id);
                            updateStats();
                            currentWordIndex++;

                            if (currentWordIndex < vocabulary.length) {
                                updateAutoStudyStatus('⏭️ 다음 카드로...');
                                showAutoStudyCard();
                                // Continue playback
                                setTimeout(() => {
                                    playAutoStudySequence();
                                }, autoStudyState.delayBetweenCards);
                            } else {
                                showAutoStudyComplete();
                            }
                        }, autoStudyState.delayBetweenSteps + 1500); // Wait for example translation to finish

                    }, autoStudyState.delayBetweenSteps + 2500); // Wait for example to finish

                }, autoStudyState.delayBetweenSteps + 1200); // Wait for meaning to finish

            }, autoStudyState.delayBetweenSteps + 1500); // Wait for word to finish
        }

        function updateAutoStudyStatus(message) {
            const statusEl = document.getElementById('auto-study-status');
            if (statusEl) {
                statusEl.textContent = message;
            }
        }

        async function showAutoStudyComplete() {
            // Check if we should auto-advance to next stage/level
            if (await autoAdvanceToNextStage()) {
                return; // Auto-advance in progress
            }

            // All stages and levels completed - show final completion
            autoStudyState.isPlaying = false;
            localStorage.removeItem('autoStudyProgress'); // Clear saved progress

            document.getElementById('game-area').innerHTML = `
                <div class="auto-study-container" style="justify-content: center; align-items: center;">
                    <div style="text-align: center; max-width: 800px;">
                        <h2 style="font-size: var(--text-5xl); margin-bottom: var(--space-6); color: var(--success);">🎉 학습 완료!</h2>
                        <p style="font-size: var(--text-2xl); color: var(--success); margin-bottom: var(--space-4);">
                            현재 스테이지 완료!
                        </p>
                        <p style="font-size: var(--text-xl); color: var(--primary); margin-bottom: var(--space-8);">
                            ${vocabulary.length}개 단어를 학습했습니다
                        </p>
                        <div style="display: flex; gap: var(--space-4); justify-content: center; flex-wrap: wrap;">
                            <button class="auto-study-btn play-pause-btn" onclick="startAutoStudyFromBeginning()" style="padding: var(--space-4) var(--space-8); font-size: var(--text-lg);">
                                🔄 다시 학습
                            </button>
                            <button class="auto-study-btn stop-btn" onclick="showModeSelection()" style="padding: var(--space-4) var(--space-8); font-size: var(--text-lg);">
                                📚 모드 선택
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Auto-advance to next stage or level
        async function autoAdvanceToNextStage() {
            if (!stagesMetadata) return false;

            const levelMeta = stagesMetadata.levels[selectedLevel];
            if (!levelMeta) return false;

            // Check if there's a next stage in current level
            const currentStageIndex = levelMeta.stages.findIndex(s => s.stageNumber === selectedStage);
            if (currentStageIndex >= 0 && currentStageIndex < levelMeta.stages.length - 1) {
                // Advance to next stage
                const nextStage = levelMeta.stages[currentStageIndex + 1];

                updateAutoStudyStatus(`⏭️ 다음 스테이지로 이동 중... (${selectedLevel} Stage ${nextStage.stageNumber})`);

                await new Promise(resolve => setTimeout(resolve, 2000)); // Brief pause before advancing

                await selectStage(nextStage.stageNumber);
                currentWordIndex = 0;
                localStorage.removeItem('autoStudyProgress');

                // Restart auto-study for new stage
                showAutoStudyCard();
                setTimeout(() => {
                    startAutoStudyPlayback();
                }, 1000);

                return true;
            }

            // No more stages in current level - check for next level
            const levels = ['N5', 'N4', 'N3', 'N2', 'N1'];
            const currentLevelIndex = levels.indexOf(selectedLevel);

            if (currentLevelIndex >= 0 && currentLevelIndex < levels.length - 1) {
                // Advance to next level
                const nextLevel = levels[currentLevelIndex + 1];

                updateAutoStudyStatus(`🎯 다음 레벨로 이동 중... (${nextLevel})`);

                await new Promise(resolve => setTimeout(resolve, 3000)); // Longer pause for level change

                await selectLevel(nextLevel);
                currentWordIndex = 0;
                localStorage.removeItem('autoStudyProgress');

                // Start with stage 1 of new level
                currentMode = 'auto-study';
                showAutoStudyCard();
                setTimeout(() => {
                    startAutoStudyPlayback();
                }, 1000);

                return true;
            }

            // No more levels - truly complete
            return false;
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (currentMode === 'flashcard') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    flipCard();
                } else if (e.code === 'ArrowLeft') {
                    markAnswer(false);
                } else if (e.code === 'ArrowRight') {
                    markAnswer(true);
                } else if (e.code === 'KeyS') {
                    playCurrentWord();
                }
            } else if (currentMode === 'auto-study') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    toggleAutoStudy();
                } else if (e.code === 'Escape') {
                    stopAutoStudy();
                }
            }
        });

        // Initialize app when DOM is loaded
        window.addEventListener('DOMContentLoaded', async () => {
            await initializeApp();
            updateStats();
        });
    </script>
</body>
</html>
